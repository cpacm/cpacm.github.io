<!doctype html>



  


<html class="theme-next muse use-motion">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="java,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1">






<meta name="description" content="这是一篇关于《Java编程思想》(Think in java)的阅读笔记，主要记录一些平时不懂和忽略的知识以及会补充一点自己的心得。所列知识点全部都是针对自己个人而言，如有不全，纯属正常。">
<meta name="keywords" content="java">
<meta property="og:type" content="article">
<meta property="og:title" content="Java编程思想阅读笔记">
<meta property="og:url" content="http://www.cpacm.net/2016/11/29/Java编程思想阅读笔记/index.html">
<meta property="og:site_name" content="cpacm">
<meta property="og:description" content="这是一篇关于《Java编程思想》(Think in java)的阅读笔记，主要记录一些平时不懂和忽略的知识以及会补充一点自己的心得。所列知识点全部都是针对自己个人而言，如有不全，纯属正常。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://7xi4up.com1.z0.glb.clouddn.com/%E7%AD%96%E7%95%A5.bmp">
<meta property="og:image" content="http://7xi4up.com1.z0.glb.clouddn.com/%E9%80%82%E9%85%8D%E5%99%A8.png">
<meta property="og:image" content="http://images.cnitblog.com/blog/685583/201411/091813238311297.png">
<meta property="og:updated_time" content="2016-11-29T15:19:34.466Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java编程思想阅读笔记">
<meta name="twitter:description" content="这是一篇关于《Java编程思想》(Think in java)的阅读笔记，主要记录一些平时不懂和忽略的知识以及会补充一点自己的心得。所列知识点全部都是针对自己个人而言，如有不全，纯属正常。">
<meta name="twitter:image" content="http://7xi4up.com1.z0.glb.clouddn.com/%E7%AD%96%E7%95%A5.bmp">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Java编程思想阅读笔记 | cpacm </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?400b16383d4e24e7e0c1604aa14354a4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">cpacm</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">动漫中毒者，技术宅</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Java编程思想阅读笔记
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-11-29T23:05:10+08:00" content="2016-11-29">
              2016-11-29
            </time>
          </span>

          
            <span class="post-category">
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/11/29/Java编程思想阅读笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/11/29/Java编程思想阅读笔记/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/11/29/Java编程思想阅读笔记/" class="leancloud_visitors" data-flag-title="Java编程思想阅读笔记">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="第一章（对象导论）"><a href="#第一章（对象导论）" class="headerlink" title="第一章（对象导论）"></a>第一章（对象导论）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Hello every one,I'm cpacm"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这一章是java的整体介绍，让我们先熟悉了java是什么。其具体的内容都会在后面介绍。</p>
<h3 id="面向基本语言的五大特性"><a href="#面向基本语言的五大特性" class="headerlink" title="面向基本语言的五大特性"></a>面向基本语言的五大特性</h3><ul>
<li>万物皆为对象。</li>
<li>程序是对象的集合，它们通过发送消息来告知彼此所要做的。</li>
<li>每个对象都拥有其类型。</li>
<li>某一特定类型的所有对象都可以接收同样的消息。</li>
</ul>
<h2 id="第二章（一切都是对象）"><a href="#第二章（一切都是对象）" class="headerlink" title="第二章（一切都是对象）"></a>第二章（一切都是对象）</h2><h3 id="一、存储"><a href="#一、存储" class="headerlink" title="一、存储"></a>一、存储</h3><p>栈（堆栈）：存放基本类型变量和对象引用变量。位于RAM区<br>堆：存放new得到的对象和数组。也位于RAM区<br>常量存储：存放常量，包括静态变量。</p>
<h3 id="二、基本类型"><a href="#二、基本类型" class="headerlink" title="二、基本类型"></a>二、基本类型</h3><p>基本数据类型在没有初始化的时候会获得一个默认值。</p>
<table>
<thead>
<tr>
<th align="center">基本数据类型</th>
<th align="center">默认值</th>
<th align="center">大小</th>
</tr>
</thead>
<tbody><tr>
<td align="center">boolean</td>
<td align="center">false</td>
<td align="center">未确定</td>
</tr>
<tr>
<td align="center">char</td>
<td align="center">null</td>
<td align="center">16bits</td>
</tr>
<tr>
<td align="center">byte</td>
<td align="center">0</td>
<td align="center">8bits</td>
</tr>
<tr>
<td align="center">short</td>
<td align="center">0</td>
<td align="center">16bits</td>
</tr>
<tr>
<td align="center">int</td>
<td align="center">0</td>
<td align="center">32bits</td>
</tr>
<tr>
<td align="center">float</td>
<td align="center">0f</td>
<td align="center">32bits</td>
</tr>
<tr>
<td align="center">long</td>
<td align="center">0L</td>
<td align="center">64bits</td>
</tr>
<tr>
<td align="center">double</td>
<td align="center">0d</td>
<td align="center">64bits</td>
</tr>
</tbody></table>
<p><em>tip1:String不是基本数据类型</em><br><em>tip2:上面的初始默认值并不适用于方法内部变量。其默认初始化值未知。当使用未初始化的变量编译器会返回错误</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseType</span> </span>&#123;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">boolean</span> b;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">byte</span> bt;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">short</span> s;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">float</span> f;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">long</span> l;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">double</span> d;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"类变量——"</span>+<span class="string">"boolean:"</span>+b+<span class="string">" char:"</span>+c+<span class="string">" byte:"</span>+bt+<span class="string">" short:"</span>+s+<span class="string">" int:"</span>+i+<span class="string">" float:"</span>+f+<span class="string">" long:"</span>+l+<span class="string">" double:"</span>+d);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//类变量——boolean:false char:  byte:0 short:0 int:0 float:0.0 long:0 double:0.0</span></span><br></pre></td></tr></table></figure>

<h2 id="第三章（操作符）"><a href="#第三章（操作符）" class="headerlink" title="第三章（操作符）"></a>第三章（操作符）</h2><h3 id="一、别名现象"><a href="#一、别名现象" class="headerlink" title="一、别名现象"></a>一、别名现象</h3><p>当两个变量包含的是同一个引用时，修改其中一个变量的值另一个变量的值也同时改变。记住new出来的对象的=赋值都是只传递引用。<br><em>Tip:减少为对象赋值。</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Assigment</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		T t1 = <span class="keyword">new</span> T();</span><br><span class="line">		T t2 = <span class="keyword">new</span> T();</span><br><span class="line">		t1.i = <span class="number">5</span>;</span><br><span class="line">		t2.i = <span class="number">8</span>;</span><br><span class="line">		t1 = t2;</span><br><span class="line">		t1.i = <span class="number">10000</span>;</span><br><span class="line">		System.out.println(t2.i);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//10000</span></span><br></pre></td></tr></table></figure>

<h3 id="二、equals方法"><a href="#二、equals方法" class="headerlink" title="二、equals方法"></a>二、equals方法</h3><p>在自定义的对象中使用equals方法时需要覆盖此方法，否则默认是<em>比较引用</em>。</p>
<h3 id="三、短路"><a href="#三、短路" class="headerlink" title="三、短路"></a>三、短路</h3><p>其现象本质为：当已经确定一个逻辑表达式的结果时不会再计算剩余的部分。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShortCircuit</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">boolean</span> flag1 = test1()&amp;&amp;test2()||test3()&amp;&amp;test4();</span><br><span class="line">		System.out.println(<span class="string">"\n"</span>);</span><br><span class="line">		<span class="keyword">boolean</span> flag2 = test1()&amp;&amp;test3()||test2()&amp;&amp;test4();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"test1"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"test2"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"test3"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"test4"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">test1</span></span><br><span class="line"><span class="comment">test2</span></span><br><span class="line"><span class="comment">test3</span></span><br><span class="line"><span class="comment">test4</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">test1</span></span><br><span class="line"><span class="comment">test3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>boolean flag2 = test1()&amp;&amp;test3()||test2()&amp;&amp;test4();<br>若test1为true,test3为true时，因为前面这部分已经确定为true,所以后面部分不会被调用。</p>
<h3 id="四、e"><a href="#四、e" class="headerlink" title="四、e"></a>四、e</h3><p>科学与工程领域中，”e”代表自然对数的基数，为2.718。<br>而在C,C++和java（或者更多的语言）中，”e”代表“10的幂次”<br>$1.39e-43f  =  1.39*10^{-43}$</p>
<h3 id="五、位操作"><a href="#五、位操作" class="headerlink" title="五、位操作"></a>五、位操作</h3><p>与，或，异或，非 <code>&amp;,|,^,~</code><br>与：所有的位都为1则输出1，否则输出0；<br>或：只要有一个位是1就输出1；<br>异或：两个位值相等时输出1；<br>非：1输出0,0输出1.<br><em>位运算不会出现短路现象。</em><br>移位操作符：<br>$&lt;&lt;$:操作数向左移动，低位补0；<br>$&gt;&gt;$:操作数向右移动，(1)符号为正时，高位补0，(2)符号为负时，高位补1；<br>$&gt;&gt;&gt;$:java独有操作符，操作数向右移动，高位统一补0。<br>char，byte，short进行移位操作时先会转成int类型，即32位</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">URShift</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">1024</span>;</span><br><span class="line">		System.out.println(Integer.toBinaryString(i));</span><br><span class="line">		i &gt;&gt;= <span class="number">10</span>;</span><br><span class="line">		System.out.println(Integer.toBinaryString(i));</span><br><span class="line">		i = -<span class="number">1</span>;</span><br><span class="line">		System.out.println(Integer.toBinaryString(i));</span><br><span class="line">		i &gt;&gt;&gt;= <span class="number">10</span>;</span><br><span class="line">		System.out.println(Integer.toBinaryString(i));</span><br><span class="line">		i &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">		System.out.println(Integer.toBinaryString(i));</span><br><span class="line">		<span class="keyword">short</span> s = -<span class="number">1</span>;</span><br><span class="line">		s &gt;&gt;&gt;= <span class="number">10</span>;<span class="comment">//s移位后得到的结果在赋值时会强行转为int,所以移位后的s已经是int型</span></span><br><span class="line">		System.out.println(Integer.toBinaryString(s));</span><br><span class="line">		s = -<span class="number">1</span>;</span><br><span class="line">		System.out.println(Integer.toBinaryString(s&gt;&gt;&gt;<span class="number">10</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">10000000000</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">11111111111111111111111111111111</span></span><br><span class="line"><span class="comment">1111111111111111111111</span></span><br><span class="line"><span class="comment">11111111111111111111110</span></span><br><span class="line"><span class="comment">11111111111111111111111111111111</span></span><br><span class="line"><span class="comment">1111111111111111111111</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="六、截尾"><a href="#六、截尾" class="headerlink" title="六、截尾"></a>六、截尾</h3><p>将float或double转型为整数值时，总是对数字进行截尾，不会进行四舍五入。如果想要得到舍入的结果可以使用Math.round()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CastingNumbers</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">double</span> d = <span class="number">1.7</span>d;</span><br><span class="line">		<span class="keyword">int</span> i = (<span class="keyword">int</span>)d;</span><br><span class="line">		System.out.println(i);</span><br><span class="line">		i = (<span class="keyword">int</span>) Math.round(d);</span><br><span class="line">		System.out.println(i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//2</span></span><br></pre></td></tr></table></figure>

<h2 id="第四章（控制执行流程）"><a href="#第四章（控制执行流程）" class="headerlink" title="第四章（控制执行流程）"></a>第四章（控制执行流程）</h2><h3 id="一、goto-标签"><a href="#一、goto-标签" class="headerlink" title="一、goto 标签"></a>一、<del>goto</del> 标签</h3><p>goto关键词，在java中则是使用标签代替臭名昭著的goto。其实在java中也是最好不要用标签来跳转语句，太伤智商。。</p>
<p><em>写法</em><br>outer:<br>并放在迭代语句前。<br>（1）continue 标签<br>跳出所有循环，并到标签位置的语句，但会重新进入紧接后面的循环里。<br>（2）break 标签<br>跳出所有循环，且不再进入紧接后面的循环里。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LabeledFor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"测试continue————————————"</span>);</span><br><span class="line">		label:</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">			System.out.println(<span class="string">"外部for循环"</span>+i);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(j==<span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">continue</span> label;</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="string">"内部循环"</span>+j);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"测试break————————————————"</span>);</span><br><span class="line">	    label2:</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">0</span>;m&lt;<span class="number">3</span>;m++)&#123;</span><br><span class="line">			System.out.println(<span class="string">"外部for循环"</span>+m);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> n=<span class="number">0</span>;n&lt;<span class="number">3</span>;n++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(n==<span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">break</span> label2;</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="string">"内部循环"</span>+n);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 测试continue————————————</span></span><br><span class="line"><span class="comment">外部for循环0</span></span><br><span class="line"><span class="comment">内部循环0</span></span><br><span class="line"><span class="comment">外部for循环1</span></span><br><span class="line"><span class="comment">内部循环0</span></span><br><span class="line"><span class="comment">外部for循环2</span></span><br><span class="line"><span class="comment">内部循环0</span></span><br><span class="line"><span class="comment">测试break————————————————</span></span><br><span class="line"><span class="comment">外部for循环0</span></span><br><span class="line"><span class="comment">内部循环0*/</span></span><br></pre></td></tr></table></figure>

<h2 id="第五章（初始化与清理）"><a href="#第五章（初始化与清理）" class="headerlink" title="第五章（初始化与清理）"></a>第五章（初始化与清理）</h2><h3 id="一、重载"><a href="#一、重载" class="headerlink" title="一、重载"></a>一、重载</h3><p>重载主要以传入参数及顺序来区别。不能通过返回值来区别<br>以基本数据类型传入时:自动包装机制<br>（1）若传入的数据类型小于方法中声明的形式参数类型，实际数据类型就会提升。<br>byte-&gt;short-&gt;int-&gt;long-&gt;float-&gt;double<br>（2）如果传入的实际参数较大，就得通过类型转换执行窄化转换。</p>
<h3 id="二、垃圾回收机制"><a href="#二、垃圾回收机制" class="headerlink" title="二、垃圾回收机制"></a>二、垃圾回收机制</h3><p><em>标记-清扫（Android中使用这个技术）</em><br>从堆栈和存储区出发，遍历所有的引用，进而找出所有存活的对象，并给与标记。遍历完成后，清理所有未被标记的对象。<br><em>停止-复制</em><br>先暂停程序的运行，然后将所有存活的对象复制到另一个堆，而没有复制的是可回收的内存。</p>
<h3 id="三、初始化顺序"><a href="#三、初始化顺序" class="headerlink" title="三、初始化顺序"></a>三、初始化顺序</h3><p>所有的变量都会在任何方法（包括构造器）被调用之前得到初始化。<br>无论创建多少对象，静态数据都只占用一份存储区域，static不能作用于局部变量。且静态初始化动作只执行一次。</p>
<h3 id="四、可变参数列表。"><a href="#四、可变参数列表。" class="headerlink" title="四、可变参数列表。"></a>四、可变参数列表。</h3><p><code>void method(Object... args){}</code></p>
<p>调用:<br>method();或method(new Object[]{1,2,3,4});</p>
<h2 id="第六章（访问权限控制）"><a href="#第六章（访问权限控制）" class="headerlink" title="第六章（访问权限控制）"></a>第六章（访问权限控制）</h2><h3 id="一、访问权限途径"><a href="#一、访问权限途径" class="headerlink" title="一、访问权限途径"></a>一、访问权限途径</h3><p>取得某一成员的访问权限途径：</p>
<ul>
<li>（1）该成员访问权限为public，这样谁都可以访问该成员。</li>
<li>（2）不加访问权限修饰词并将其他类放置于同一个包内的方式给成员赋予包访问权。于是包内的其他类也可以访问。</li>
<li>（3）继承的类可以访问public和protected方法。</li>
<li>（4）通过提供访问器set,get来读取和改变值。</li>
</ul>
<h2 id="第七章（复用类）"><a href="#第七章（复用类）" class="headerlink" title="第七章（复用类）"></a>第七章（复用类）</h2><h3 id="一、toString-的自动调用"><a href="#一、toString-的自动调用" class="headerlink" title="一、toString()的自动调用"></a>一、toString()的自动调用</h3><p>有时候编译器会自动帮你调用toString()方法。<br>“source”+ source;这时候会自动调用source对象的toString方法。</p>
<h3 id="二、构造函数调用顺序"><a href="#二、构造函数调用顺序" class="headerlink" title="二、构造函数调用顺序"></a>二、构造函数调用顺序</h3><p>构造函数总是从基类开始。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Insert</span></span>&#123;</span><br><span class="line">	Insert()&#123;</span><br><span class="line">		System.out.println(<span class="string">"Insert"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Beetle</span> <span class="keyword">extends</span> <span class="title">Insert</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	Beetle()&#123;</span><br><span class="line">		System.out.println(<span class="string">"Beetle"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		Beetle b = <span class="keyword">new</span> Beetle();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Insert</span></span><br><span class="line"><span class="comment">//Beetle</span></span><br></pre></td></tr></table></figure>

<h3 id="三、final"><a href="#三、final" class="headerlink" title="三、final"></a>三、final</h3><p>对于基本类型，final使数值恒定不变；而用于对象引用，final使引用恒定不变，但对象本身是可以改变的。<br>private 属于 final 方法<br>static final是属于类属性，即能被类调用，不用实例化<br>final则需要实例化。</p>
<h3 id="四、组合模式"><a href="#四、组合模式" class="headerlink" title="四、组合模式"></a>四、组合模式</h3><p>组合模式可以看做是一颗树，每个枝干都可以长出新的枝干，它们的结构都是相同的。<br>将枝干抽象为一个类，里面包含链接下一个节点的方法，若需要不断的链接下一个节点只需要继承这个方法并实现。<br><em>示例：导航菜单</em><br>组合模式，将对象组合成树形结构以表示“部分-整体”的层次结构，组合模式使得用户对单个对象和组合对象的使用具有一致性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Tab</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Tab</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.title = title;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Tab tab)</span></span>;  </span><br><span class="line">	  </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">romove</span><span class="params">(Tab tab)</span></span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CardTab</span> <span class="keyword">extends</span> <span class="title">Tab</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CardTab</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(title);</span><br><span class="line">		<span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> List&lt;Tab&gt; tabs;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Tab tab)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		tabs.add(tab);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">romove</span><span class="params">(Tab tab)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		tabs.remove(tab);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TabView</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		CardTab rootTab = <span class="keyword">new</span> CardTab(<span class="string">"roottab"</span>);</span><br><span class="line">		CardTab tab1 = <span class="keyword">new</span> CardTab(<span class="string">"tab1"</span>);</span><br><span class="line">		CardTab tab2 = <span class="keyword">new</span> CardTab(<span class="string">"tab2"</span>);</span><br><span class="line">		CardTab tab3 = <span class="keyword">new</span> CardTab(<span class="string">"tab3"</span>);</span><br><span class="line">		rootTab.add(tab1);</span><br><span class="line">		rootTab.add(tab2);</span><br><span class="line">		rootTab.add(tab3);</span><br><span class="line">		CardTab tab4 = <span class="keyword">new</span> CardTab(<span class="string">"tab1-1"</span>);</span><br><span class="line">		CardTab tab5 = <span class="keyword">new</span> CardTab(<span class="string">"tab1-2"</span>);</span><br><span class="line">		tab1.add(tab4);</span><br><span class="line">		tab1.add(tab5);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 这样子Tab组成了一个导航列表,这就是一个简单的组合模式.</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<h2 id="第八章（多态）"><a href="#第八章（多态）" class="headerlink" title="第八章（多态）"></a>第八章（多态）</h2><p>多态是一项让程序员“将改变的事物与未变的事物分离开来”的重要技术。</p>
<h3 id="一、多态缺陷"><a href="#一、多态缺陷" class="headerlink" title="一、多态缺陷"></a>一、多态缺陷</h3><p>缺陷1：只有非private方法才可以被覆盖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> field = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getField</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> field;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span> <span class="keyword">extends</span> <span class="title">Super</span> </span>&#123;</span><br><span class="line">      <span class="keyword">public</span> <span class="keyword">int</span> field = <span class="number">1</span>;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getField</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> field; &#125;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSuperField</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">super</span>.field; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FiledAccess</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Super sup = <span class="keyword">new</span> Sub(); <span class="comment">// Upcast</span></span><br><span class="line">        System.out.println(<span class="string">"sup.field = "</span> + sup.field +</span><br><span class="line">          <span class="string">", sup.getField() = "</span> + sup.getField());</span><br><span class="line">        Sub sub = <span class="keyword">new</span> Sub();</span><br><span class="line">        System.out.println(<span class="string">"sub.field = "</span> +</span><br><span class="line">          sub.field + <span class="string">", sub.getField() = "</span> +</span><br><span class="line">          sub.getField() +</span><br><span class="line">          <span class="string">", sub.getSuperField() = "</span> +</span><br><span class="line">          sub.getSuperField());</span><br><span class="line">      &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">sup.field = <span class="number">0</span>, sup.getField() = <span class="number">1</span></span><br><span class="line">sub.field = <span class="number">1</span>, sub.getField() = <span class="number">1</span>, sub.getSuperField() = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>缺陷2：域和静态方法直接在编译时候进行解析，所以多态不会对其产生作用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StaticSuper</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">staticGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Base staticGet()"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">dynamicGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Base dynamicGet()"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StaticSub</span> <span class="keyword">extends</span> <span class="title">StaticSuper</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">staticGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Derived staticGet()"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">dynamicGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Derived dynamicGet()"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticPolymorphism</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    StaticSuper sup = <span class="keyword">new</span> StaticSub(); <span class="comment">// Upcast</span></span><br><span class="line">    System.out.println(sup.staticGet());</span><br><span class="line">    System.out.println(sup.dynamicGet());</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">Base staticGet()</span></span><br><span class="line"><span class="comment">Derived dynamicGet() */</span></span><br></pre></td></tr></table></figure>

<h3 id="二、断言"><a href="#二、断言" class="headerlink" title="二、断言"></a>二、断言</h3><p>@Override作用：<br>断言，如果我们使用了这种annotation在一个没有覆盖父类方法的方法时，java编译器将以一个编译错误来警示</p>
<h3 id="三、构造器构造顺序"><a href="#三、构造器构造顺序" class="headerlink" title="三、构造器构造顺序"></a>三、构造器构造顺序</h3><p>构造器在多态时的构造顺序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line">    Meal() &#123;</span><br><span class="line">        P.print(<span class="string">"Meal()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bread</span> </span>&#123;</span><br><span class="line">    Bread() &#123;</span><br><span class="line">        P.print(<span class="string">"Bread()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cheese</span> </span>&#123;</span><br><span class="line">    Cheese() &#123;</span><br><span class="line">        P.print(<span class="string">"Cheese()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lettuce</span> </span>&#123;</span><br><span class="line">    Lettuce() &#123;</span><br><span class="line">        P.print(<span class="string">"Lettuce()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lunch</span> <span class="keyword">extends</span> <span class="title">Meal</span> </span>&#123;</span><br><span class="line">    Lunch() &#123;</span><br><span class="line">        P.print(<span class="string">"Lunch()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PortableLunch</span> <span class="keyword">extends</span> <span class="title">Lunch</span> </span>&#123;</span><br><span class="line">    PortableLunch() &#123;</span><br><span class="line">        P.print(<span class="string">"PortableLunch()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sandwich</span> <span class="keyword">extends</span> <span class="title">PortableLunch</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Bread b = <span class="keyword">new</span> Bread();</span><br><span class="line">    <span class="keyword">private</span> Cheese c = <span class="keyword">new</span> Cheese();</span><br><span class="line">    <span class="keyword">private</span> Lettuce l = <span class="keyword">new</span> Lettuce();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sandwich</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        P.print(<span class="string">"Sandwich()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Sandwich();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">P</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String s)</span></span>&#123;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出：</span><br><span class="line">Meal()</span><br><span class="line">Lunch()</span><br><span class="line">PortableLunch()</span><br><span class="line">Bread()</span><br><span class="line">Cheese()</span><br><span class="line">Lettuce()</span><br><span class="line">Sandwich()</span><br></pre></td></tr></table></figure>

<p>解释说明：<br>一个继承类实例化的时候必须要确保所使用的成员已经构建完毕，所以必须先调用基类的构造器，所以当实例化Sandwich对象时先调用其基类的构造方法：<br>Meal()<br>Lunch()<br>PortableLunch()<br>其次对成员变量进行初始化<br>Bread()<br>Cheese()<br>Lettuce()<br>最后调用构造器<br>Sandwich()</p>
<h3 id="三、构造器初始化"><a href="#三、构造器初始化" class="headerlink" title="三、构造器初始化"></a>三、构造器初始化</h3><p>初始化的过程：<br>（1）在所有事物发生之前，将分配给对象的存储空间初始化为二进制的零。<br>（2）调用基类构造器。<br>（3）按照声明顺序调用成员的初始化方法。<br>（4）调用导出类（本体）的构造器主体。</p>
<h2 id="第九章（接口）"><a href="#第九章（接口）" class="headerlink" title="第九章（接口）"></a>第九章（接口）</h2><p>任何抽象性都应该是应真正的需求而产生的。</p>
<h3 id="访问权限"><a href="#访问权限" class="headerlink" title="访问权限"></a>访问权限</h3><p>interface如果不加public关键字，则只具有包访问权限。</p>
<h3 id="重名"><a href="#重名" class="headerlink" title="重名"></a>重名</h3><p>可以通过extends来扩展接口，但在实现多重继承时要注意不能实现签名或返回类型不同的接口方法，除非其传入参数不一样。最好避免使用同一个方法名称。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">M</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">menace</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">kill</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Danger</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">menace</span><span class="params">(<span class="keyword">int</span> s)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">kill</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Vampire</span> <span class="keyword">extends</span> <span class="title">Danger</span>,<span class="title">M</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Monster</span> <span class="keyword">implements</span> <span class="title">Vampire</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello,every one,I'm cpacm"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">menace</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">kill</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">menace</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tip:切勿过渡设计</p>
<h3 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h3><p>去商店去买东西，可以选择不同的出行方式但都能达到买东西的目的，这种选择模式就是策略模式。<br>把出行方式抽象为一个接口，实现公交车，自行车，走路，出租车等实例，最后自己决定使用哪种方式。</p>
<p>策略模式：定义一系列的算法,把每一个算法封装起来, 并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化。也称为政策模式(Policy)。策略模式把对象本身和运算规则区分开来，其功能非常强大，因为这个设计模式本身的核心思想就是面向对象编程的多形性的思想。<br>环境类(Context):用一个ConcreteStrategy对象来配置。维护一个对Strategy对象的引用。可定义一个接口来让Strategy访问它的数据。<br>抽象策略类(Strategy):定义所有支持的算法的公共接口。 Context使用这个接口来调用某ConcreteStrategy定义的算法。<br>具体策略类(ConcreteStrategy):以Strategy接口实现某具体算法。<br><img src="http://7xi4up.com1.z0.glb.clouddn.com/%E7%AD%96%E7%95%A5.bmp" alt="策略模式"></p>
<h3 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h3><p>将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以在一起工作。<br>在Android中常用到的各种Adapter就是用的适配器模式思想。<br><img src="http://7xi4up.com1.z0.glb.clouddn.com/%E9%80%82%E9%85%8D%E5%99%A8.png" alt="适配器模式"></p>
<h3 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h3><p>工厂模式主要用以下几种形态：</p>
<ol>
<li>简单工厂（Simple Factory）: 主要代码由一个Factory管理，每添加一个产品都需要在factory类中修改代码；</li>
<li>工厂方法（Factory Method）:一种产品对应一个工厂，增加一种产品就同时增加一个工厂；</li>
<li>抽象工厂（Abstract Factory）:通常用于多种产品且每种都有不同型号的情况下，针对型号建立工厂，每个工厂只生产该型号的产品。</li>
</ol>
<p>抽象工厂和工厂可以根据不同情况下相互转化。</p>
<h2 id="第十章（内部类）"><a href="#第十章（内部类）" class="headerlink" title="第十章（内部类）"></a>第十章（内部类）</h2><h3 id="一、访问权"><a href="#一、访问权" class="headerlink" title="一、访问权"></a>一、访问权</h3><p>内部类拥有其外围类的所有元素的访问权。<br>意思是通过内部类能够获得其外部类的内存信息（参数值）。<br>故不能直接通过创建普通对象的方法创建内部类，必须要通过外部类才能创建。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DotThis</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DotThis.f()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Inner</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> DotThis <span class="title">outer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> DotThis.<span class="keyword">this</span>;</span><br><span class="line">            <span class="comment">// A plain "this" would be Inner's "this"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Inner <span class="title">inner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Inner();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        DotThis dt = <span class="keyword">new</span> DotThis();</span><br><span class="line">        DotThis.Inner dti = dt.inner();</span><br><span class="line">        dti.outer().f();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="二、-new"><a href="#二、-new" class="headerlink" title="二、.new"></a>二、.new</h3><p>.new语法，可以直接创建其内部类，但前提也是要提供其外部类的引用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DotNew</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Inner</span></span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        DotNew dn = <span class="keyword">new</span> DotNew();</span><br><span class="line">        DotNew.Inner dti = dn.new Inner();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当内部类向上转型为基类或接口时，往往是为了隐藏实现细节。</p>
<h3 id="三、局部"><a href="#三、局部" class="headerlink" title="三、局部"></a>三、局部</h3><p>内部类可以嵌入在任何堆作用域内，但只在其作用域内可用。称作为局部内部类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parcel6</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">inTrack</span><span class="params">(<span class="keyword">boolean</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(b)&#123;</span><br><span class="line">            <span class="class"><span class="keyword">class</span> <span class="title">TrackSlip</span></span>&#123;</span><br><span class="line">                <span class="keyword">private</span> String id;</span><br><span class="line">                TrackSlip(String s)&#123;</span><br><span class="line">                    id = s;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="function">String <span class="title">getSlip</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> id;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            TrackSlip ts = <span class="keyword">new</span> TrackSlip(<span class="string">"slip"</span>);</span><br><span class="line">            String s = ts.getSlip();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//TrackSlip ts = new TrackSlip("slip"); //run error</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">track</span><span class="params">()</span></span>&#123;</span><br><span class="line">        inTrack(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        Parcel6 p = <span class="keyword">new</span> Parcel6();</span><br><span class="line">        p.track();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="四、匿名内部类"><a href="#四、匿名内部类" class="headerlink" title="四、匿名内部类"></a>四、匿名内部类</h3><p>匿名内部类是一个没有名字的内部类，通常使用它来简化代码编写，同时必须继承一个父类或实现一个接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parcel7</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Thread t = <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">                    System.out.print(i + <span class="string">" "</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        t.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1 2 3 4 5</span></span><br></pre></td></tr></table></figure>

<p>tip:常用的扩展是将只使用一次的工厂类作为匿名内部类放在生产类上。</p>
<h3 id="五、嵌套类"><a href="#五、嵌套类" class="headerlink" title="五、嵌套类"></a>五、嵌套类</h3><p>将内部类声明为static时，此时就作为嵌套类使用。创建嵌套类的对象并不需要外围对象，同时也不能从嵌套类的对象中访问非静态的外围对象。</p>
<h3 id="六、接口内部类"><a href="#六、接口内部类" class="headerlink" title="六、接口内部类"></a>六、接口内部类</h3><p>在接口中可以放入嵌套类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ClassInInterface</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">howdy</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">ClassInInterface</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">howdy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">            System.out.println(<span class="string">"Howdy!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">new</span> Test().howdy();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="七、内部类作用"><a href="#七、内部类作用" class="headerlink" title="七、内部类作用"></a>七、内部类作用</h3><p>使用内部类的一些好处</p>
<ol>
<li>可以解决多重继承的问题，因为内部类可以访问外围类的信息，所以获得内部类相当于获得外围类和内部类两种信息。</li>
<li>在一个外围类中，可以让多个内部类以不同的方式实现同一个接口或类从而实现不同的特性。</li>
</ol>
<h3 id="八、模版模式"><a href="#八、模版模式" class="headerlink" title="八、模版模式"></a>八、模版模式</h3><p>模板方法模式：定义一个操作中算法的框架，而将一些步骤延迟到子类中。模板方法模式使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。<br>模板模式需要一个抽象类和继承该抽象类的子类来实现。同样使用出门买东西的情景：出门-&gt;买东西-&gt;回来。</p>
<p>我们不关心怎么出去和回来，所以把出门和回来的方法写在抽象类中，然后将买东西这个方法抽象化放在抽象类中以便子类实现。<br>接着创建子类继承抽象类，买一种东西可以创建一个新类，从而实现抽象方法。</p>
<p>而策略模式是使用委托方法实现的，需要一个用来实现<br>方法的接口存在。<br>模板模式和策略模式通常可以互相替换。</p>
<h3 id="九、命令设计模式"><a href="#九、命令设计模式" class="headerlink" title="九、命令设计模式"></a>九、命令设计模式</h3><p>命令模式的结构<br>        顾名思义，命令模式就是对命令的封装，首先来看一下命令模式类图中的基本结构：<br>Command类：是一个抽象类，类中对需要执行的命令进行声明，一般来说要对外公布一个execute方法用来执行命令。<br>ConcreteCommand类：Command类的实现类，对抽象类中声明的方法进行实现。<br>Client类：最终的客户端调用类。<br>        以上三个类的作用应该是比较好理解的，下面我们重点说一下Invoker类和Recevier类。<br>Invoker类：调用者，负责调用命令。<br>Receiver类：接收者，负责接收命令并且执行命令。<br>命令模式的精髓所在：把命令的调用者与执行者分开，使双方不必关心对方是如何操作</p>
<h3 id="十、继承内部类"><a href="#十、继承内部类" class="headerlink" title="十、继承内部类"></a>十、继承内部类</h3><p>当继承内部类的时候必须在构造器中传入外围类的引用和外围类的super；</p>
<h2 id="第十一章（持有对象）"><a href="#第十一章（持有对象）" class="headerlink" title="第十一章（持有对象）"></a>第十一章（持有对象）</h2><h3 id="一、各个容器"><a href="#一、各个容器" class="headerlink" title="一、各个容器"></a>一、各个容器</h3><p>ArrayList LinkedList 都是按插入顺序存放数据<br>ArrayList在随机访问速度上比较快，而LinkedList在插入和删除数据比较有优势，具有Queue，Stack的特性。<br>HashSet TreeSet LinkedHashSet<br>HashMap TreeMap LinkedHashMap<br>通用点：Hash开头的容器都是通过Hash值来查找数据，所以特点是无序但速度快;<br>Tree开头的容器都会将存入的数据进行升序排列；<br>Linked则是按插入的顺序进行排序。<br>（后面17章会介绍其原理）</p>
<h3 id="二、迭代器"><a href="#二、迭代器" class="headerlink" title="二、迭代器"></a>二、迭代器</h3><p>迭代器具有以下特性：<br>1）创建代价小<br>2）单向移动<br>3）next()获取下一个对象，hasNext()判断是否具有下一个对象，remove()移除当前对象。</p>
<p><strong>（ListIterator作为List特有的迭代器，具有双向移动功能，其对应方法为hasPrevious(),previous()）</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.TreeSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CrossContainerIteration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(Iterator&lt;Pet&gt; it)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">            Pet p = it.next();</span><br><span class="line">            System.out.println(p.id() + <span class="string">":"</span> + p + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        List&lt;Pet&gt; pets = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        pets.add(<span class="keyword">new</span> Pet(<span class="string">"cat"</span>));</span><br><span class="line">        pets.add(<span class="keyword">new</span> Pet(<span class="string">"dog"</span>));</span><br><span class="line">        pets.add(<span class="keyword">new</span> Pet(<span class="string">"bird"</span>));</span><br><span class="line">        pets.add(<span class="keyword">new</span> Pet(<span class="string">"fish"</span>));</span><br><span class="line">        pets.add(<span class="keyword">new</span> Pet(<span class="string">"pig"</span>));</span><br><span class="line">        LinkedList&lt;Pet&gt; petsLL = <span class="keyword">new</span> LinkedList&lt;&gt;(pets);</span><br><span class="line">        HashSet&lt;Pet&gt; petsHS = <span class="keyword">new</span> HashSet&lt;&gt;(pets);</span><br><span class="line">        TreeSet&lt;Pet&gt; petsTS = <span class="keyword">new</span> TreeSet&lt;&gt;(pets);</span><br><span class="line"></span><br><span class="line">        display(pets.iterator());</span><br><span class="line">        display(petsLL.iterator());</span><br><span class="line">        display(petsHS.iterator());</span><br><span class="line">        display(petsTS.iterator());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*0:Pet cat </span></span><br><span class="line"><span class="comment">1:Pet dog </span></span><br><span class="line"><span class="comment">2:Pet bird </span></span><br><span class="line"><span class="comment">3:Pet fish </span></span><br><span class="line"><span class="comment">4:Pet pig </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">0:Pet cat </span></span><br><span class="line"><span class="comment">1:Pet dog </span></span><br><span class="line"><span class="comment">2:Pet bird </span></span><br><span class="line"><span class="comment">3:Pet fish </span></span><br><span class="line"><span class="comment">4:Pet pig </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3:Pet fish </span></span><br><span class="line"><span class="comment">1:Pet dog </span></span><br><span class="line"><span class="comment">4:Pet pig </span></span><br><span class="line"><span class="comment">2:Pet bird </span></span><br><span class="line"><span class="comment">0:Pet cat </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2:Pet bird </span></span><br><span class="line"><span class="comment">0:Pet cat </span></span><br><span class="line"><span class="comment">1:Pet dog </span></span><br><span class="line"><span class="comment">3:Pet fish </span></span><br><span class="line"><span class="comment">4:Pet pig */</span></span><br></pre></td></tr></table></figure>

<h3 id="二、栈"><a href="#二、栈" class="headerlink" title="二、栈"></a>二、栈</h3><p>后进先出<br>通常可以使用LinkedList来实现Stack的功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> LinkedList&lt;T&gt; storge = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(T v)</span></span>&#123;</span><br><span class="line">        storge.addFirst(v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">peek</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> storge.getFirst();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> storge.removeFirst();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">empty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> storge.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="三、队列"><a href="#三、队列" class="headerlink" title="三、队列"></a>三、队列</h3><p>Queue 先进先出<br>同样可以使用LinkedList来实现功能，由于其实现了Queue接口，可以将其向上转型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueueDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printQ</span><span class="params">(Queue queue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (queue.peek() != <span class="keyword">null</span>)</span><br><span class="line">            System.out.print(queue.remove() + <span class="string">" "</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Queue&lt;Integer&gt; queue = <span class="keyword">new</span> LinkedList&lt;Integer&gt;();</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">            queue.offer(rand.nextInt(i + <span class="number">10</span>));</span><br><span class="line">        printQ(queue);</span><br><span class="line">        Queue&lt;Character&gt; qc = <span class="keyword">new</span> LinkedList&lt;Character&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : <span class="string">"Brontosaurus"</span>.toCharArray())</span><br><span class="line">            qc.offer(c);</span><br><span class="line">        printQ(qc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Output: 8 1 1 1 5 14 3 1 0 1 B r o n t o s a u r u s</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<h3 id="三、优先队列"><a href="#三、优先队列" class="headerlink" title="三、优先队列"></a>三、优先队列</h3><p>PriorityQueue<br>简单来说就是具有排序功能的队列，下一个弹出的元素是在队列中优先级最高的一个。使用Comparator比较器来进行比较。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PriorityQueueDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        PriorityQueue&lt;Integer&gt; priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;Integer&gt;();</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">            priorityQueue.offer(rand.nextInt(i + <span class="number">10</span>));</span><br><span class="line">        QueueDemo.printQ(priorityQueue);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * Output: 0 1 1 1 1 1 3 5 8 14 1 1 2 3 3 9 9 14 14 18 18 20 21 22 23 25 25 25</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">        List&lt;Integer&gt; ints = Arrays.asList(<span class="number">25</span>, <span class="number">22</span>, <span class="number">20</span>, <span class="number">18</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>,</span><br><span class="line">                <span class="number">3</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">25</span>);</span><br><span class="line">        priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;Integer&gt;(ints);</span><br><span class="line">        QueueDemo.printQ(priorityQueue);</span><br><span class="line">        priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;Integer&gt;(ints.size(),</span><br><span class="line">                Collections.reverseOrder());</span><br><span class="line">        priorityQueue.addAll(ints);</span><br><span class="line">        QueueDemo.printQ(priorityQueue);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * 25 23 22 21 20 18 18 14 14 9 9 3 3 2 1 1 </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        String fact = <span class="string">"EDUCATION SHOULD ESCHEW OBFUSCATION"</span>;</span><br><span class="line">        List&lt;String&gt; strings = Arrays.asList(fact.split(<span class="string">""</span>));</span><br><span class="line">        PriorityQueue&lt;String&gt; stringPQ = <span class="keyword">new</span> PriorityQueue&lt;String&gt;(strings);</span><br><span class="line">        QueueDemo.printQ(stringPQ);</span><br><span class="line">        stringPQ = <span class="keyword">new</span> PriorityQueue&lt;String&gt;(strings.size(),</span><br><span class="line">                Collections.reverseOrder());</span><br><span class="line">        stringPQ.addAll(strings);</span><br><span class="line">        QueueDemo.printQ(stringPQ);</span><br><span class="line"></span><br><span class="line">        Set&lt;Character&gt; charSet = <span class="keyword">new</span> HashSet&lt;Character&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : fact.toCharArray())</span><br><span class="line">            charSet.add(c); <span class="comment">// Autoboxing</span></span><br><span class="line">        PriorityQueue&lt;Character&gt; characterPQ = <span class="keyword">new</span> PriorityQueue&lt;Character&gt;(</span><br><span class="line">                charSet);</span><br><span class="line">        QueueDemo.printQ(characterPQ);</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * A A B C C C D D E E E F H H I I L N</span></span><br><span class="line"><span class="comment">        * N O O O O S S S T T U U U W W U U U T T S S S O O O O N N L I I H H F E E E D</span></span><br><span class="line"><span class="comment">        * D C C C B A A A B C D E F H I L N O S T U W</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>总结：四种容器List Set Queue Map</strong></p>
<h2 id="第十二章（通过异常处理错误）"><a href="#第十二章（通过异常处理错误）" class="headerlink" title="第十二章（通过异常处理错误）"></a>第十二章（通过异常处理错误）</h2><p><strong>Java的基本理念是“结构不佳的代码不能运行</strong></p>
<h3 id="自定义异常"><a href="#自定义异常" class="headerlink" title="自定义异常"></a>自定义异常</h3><p>我们可以继承Exception类来自定义异常，在自定义异常类中可以添加一些动作，比如写入日志等等。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyException</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MyException</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">MyException</span><span class="params">(String msg)</span> </span>&#123; <span class="keyword">super</span>(msg); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FullConstructors</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> <span class="keyword">throws</span> MyException </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Throwing MyException from f()"</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> MyException();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">g</span><span class="params">()</span> <span class="keyword">throws</span> MyException </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Throwing MyException from g()"</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> MyException(<span class="string">"Originated in g()"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      f();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(MyException e) &#123;</span><br><span class="line">      e.printStackTrace(System.out);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      g();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(MyException e) &#123;</span><br><span class="line">      e.printStackTrace(System.out);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">Throwing MyException from f()</span></span><br><span class="line"><span class="comment">MyException</span></span><br><span class="line"><span class="comment">        at FullConstructors.f(FullConstructors.java:11)</span></span><br><span class="line"><span class="comment">        at FullConstructors.main(FullConstructors.java:19)</span></span><br><span class="line"><span class="comment">Throwing MyException from g()</span></span><br><span class="line"><span class="comment">MyException: Originated in g()</span></span><br><span class="line"><span class="comment">        at FullConstructors.g(FullConstructors.java:15)</span></span><br><span class="line"><span class="comment">        at FullConstructors.main(FullConstructors.java:24)</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>异常也是类的一种，所以我们可以扩展使其获得更强大的功能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyException2</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> x;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyException2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyException2</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyException2</span><span class="params">(String msg, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(msg);</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">val</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Detail Message: "</span> + x + <span class="string">" "</span> + <span class="keyword">super</span>.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExtraFeatures</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> <span class="keyword">throws</span> MyException2 </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Throwing MyException2 from f()"</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> MyException2();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">g</span><span class="params">()</span> <span class="keyword">throws</span> MyException2 </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Throwing MyException2 from g()"</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> MyException2(<span class="string">"Originated in g()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">h</span><span class="params">()</span> <span class="keyword">throws</span> MyException2 </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Throwing MyException2 from h()"</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> MyException2(<span class="string">"Originated in h()"</span>, <span class="number">47</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            f();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MyException2 e) &#123;</span><br><span class="line">            e.printStackTrace(System.out);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            g();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MyException2 e) &#123;</span><br><span class="line">            e.printStackTrace(System.out);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            h();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MyException2 e) &#123;</span><br><span class="line">            e.printStackTrace(System.out);</span><br><span class="line">            System.out.println(<span class="string">"e.val() = "</span> + e.val());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">/*</span></span><br><span class="line"><span class="comment"> Throwing MyException2 from f()</span></span><br><span class="line"><span class="comment">chapter12.MyException2: Detail Message: 0 null</span></span><br><span class="line"><span class="comment">    at chapter12.ExtraFeatures.f(ExtraFeatures.java:32)</span></span><br><span class="line"><span class="comment">    at chapter12.ExtraFeatures.main(ExtraFeatures.java:47)</span></span><br><span class="line"><span class="comment">Throwing MyException2 from g()</span></span><br><span class="line"><span class="comment">chapter12.MyException2: Detail Message: 0 Originated in g()</span></span><br><span class="line"><span class="comment">    at chapter12.ExtraFeatures.g(ExtraFeatures.java:37)</span></span><br><span class="line"><span class="comment">    at chapter12.ExtraFeatures.main(ExtraFeatures.java:52)</span></span><br><span class="line"><span class="comment">Throwing MyException2 from h()</span></span><br><span class="line"><span class="comment">chapter12.MyException2: Detail Message: 47 Originated in h()</span></span><br><span class="line"><span class="comment">    at chapter12.ExtraFeatures.h(ExtraFeatures.java:42)</span></span><br><span class="line"><span class="comment">    at chapter12.ExtraFeatures.main(ExtraFeatures.java:57)</span></span><br><span class="line"><span class="comment">e.val() = 47</span></span><br><span class="line"><span class="comment"> */</span><span class="comment">// :~</span></span><br></pre></td></tr></table></figure>

<p>所有的异常都可以由Exception进行捕获，可以通过Exception打印发生错误时所获取的信息。</p>
<h3 id="Rethrow"><a href="#Rethrow" class="headerlink" title="Rethrow"></a>Rethrow</h3><p>可以通过throw将catch到的异常重新抛出，不过异常里面是原来异常抛出的调用栈信息。可以使用 fillInStackTrace()更新，调用 fillInStackTrace那一行就成了异常的新发生地。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rethrowing</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"originating the exception in f()"</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"thrown from f()"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">g</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      f();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"Inside g(),e.printStackTrace()"</span>);</span><br><span class="line">      e.printStackTrace(System.out);</span><br><span class="line">      <span class="keyword">throw</span> e;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">h</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      f();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"Inside h(),e.printStackTrace()"</span>);</span><br><span class="line">      e.printStackTrace(System.out);</span><br><span class="line">      <span class="keyword">throw</span> (Exception)e.fillInStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      g();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"main: printStackTrace()"</span>);</span><br><span class="line">      e.printStackTrace(System.out);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      h();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"main: printStackTrace()"</span>);</span><br><span class="line">      e.printStackTrace(System.out);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">originating the exception in f()</span></span><br><span class="line"><span class="comment">Inside g(),e.printStackTrace()</span></span><br><span class="line"><span class="comment">java.lang.Exception: thrown from f()</span></span><br><span class="line"><span class="comment">        at Rethrowing.f(Rethrowing.java:7)</span></span><br><span class="line"><span class="comment">        at Rethrowing.g(Rethrowing.java:11)</span></span><br><span class="line"><span class="comment">        at Rethrowing.main(Rethrowing.java:29)</span></span><br><span class="line"><span class="comment">main: printStackTrace()</span></span><br><span class="line"><span class="comment">java.lang.Exception: thrown from f()</span></span><br><span class="line"><span class="comment">        at Rethrowing.f(Rethrowing.java:7)</span></span><br><span class="line"><span class="comment">        at Rethrowing.g(Rethrowing.java:11)</span></span><br><span class="line"><span class="comment">        at Rethrowing.main(Rethrowing.java:29)</span></span><br><span class="line"><span class="comment">originating the exception in f()</span></span><br><span class="line"><span class="comment">Inside h(),e.printStackTrace()</span></span><br><span class="line"><span class="comment">java.lang.Exception: thrown from f()</span></span><br><span class="line"><span class="comment">        at Rethrowing.f(Rethrowing.java:7)</span></span><br><span class="line"><span class="comment">        at Rethrowing.h(Rethrowing.java:20)</span></span><br><span class="line"><span class="comment">        at Rethrowing.main(Rethrowing.java:35)</span></span><br><span class="line"><span class="comment">main: printStackTrace()</span></span><br><span class="line"><span class="comment">java.lang.Exception: thrown from f()</span></span><br><span class="line"><span class="comment">        at Rethrowing.h(Rethrowing.java:24)</span></span><br><span class="line"><span class="comment">        at Rethrowing.main(Rethrowing.java:35)</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<h3 id="异常链"><a href="#异常链" class="headerlink" title="异常链"></a>异常链</h3><p>Throwable的子类可以接受一个cause对象作为参数，cause表示原始异常，这样可以通过把原始异常传递给新的异常使得可以追踪所有连接起来的异常。<br>在Throwable子类中，只有三种基本的异常类提供了带cause参数的构造器，分别为Error,Exception和RuntimeException。如果要把其他类型的异常链接起来，应该使用initCause()方法。</p>
<h3 id="return"><a href="#return" class="headerlink" title="return"></a>return</h3><p>return 与 fianl共用时，即使在try里面实行return,finally里面的代码还是会运行，<br>而在final里面使用热力return 的话，即使抛出了异常也不会产生任何输出。</p>
<h3 id="异常使用指南"><a href="#异常使用指南" class="headerlink" title="异常使用指南"></a>异常使用指南</h3><ol>
<li>在恰当的级别处理问题。</li>
<li>解决问题并且重新调用产生异常的方法。</li>
<li>进行少许修补，然后绕过异常发生的地方继续执行。</li>
<li>用别的数据进行计算，以代替异常发生的地方继续执行。</li>
<li>吧当前运行环境下能做的事情尽量做完，然后将相同的异常重抛到更高层。</li>
<li>吧当前运行环境下能做的事情尽量做完，然后将不同的异常重抛到更高层。</li>
<li>终止程序</li>
<li>进行简化。</li>
<li>蓝类库和程序更安全。</li>
</ol>
<h2 id="第十三章（字符串）"><a href="#第十三章（字符串）" class="headerlink" title="第十三章（字符串）"></a>第十三章（字符串）</h2><p>字符串具有不可变性。</p>
<h3 id="格式修饰符"><a href="#格式修饰符" class="headerlink" title="格式修饰符"></a>格式修饰符</h3><p>对字符串进行可变操作时尽量使用StringBuilder.</p>
<p>在插入数据时，如果想要控制空格与其对其，则需要更精细复杂的格式修饰符。</p>
<p><code>%[argument_index$][flags][width][.precision]conversion</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Receipt</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">double</span> total = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> Formatter f = <span class="keyword">new</span> Formatter(System.out);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printTitle</span><span class="params">()</span> </span>&#123;</span><br><span class="line">f.format(<span class="string">"%-15s %5s %10s\n"</span>, <span class="string">"Item"</span>, <span class="string">"Qty"</span>, <span class="string">"Price"</span>);</span><br><span class="line">f.format(<span class="string">"%-15s %5s %10s\n"</span>, <span class="string">"- - - -"</span>, <span class="string">"- - -"</span>, <span class="string">"- - - - -"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String name, <span class="keyword">int</span> qty, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">f.format(<span class="string">"%-15.15s %5d %10.2f\n"</span>, name, qty, price);</span><br><span class="line">total += price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">f.format(<span class="string">"%-15s %5s %10.2f\n"</span>, <span class="string">"Tax"</span>, <span class="string">""</span>, total + <span class="number">0.06</span>);</span><br><span class="line">f.format(<span class="string">"%-15s %5s %10s\n"</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">"- - - - -"</span>);</span><br><span class="line">f.format(<span class="string">"%-15s %5s %10.2f\n"</span>, <span class="string">"Total"</span>, <span class="string">""</span>, total * <span class="number">1.06</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Receipt receipt = <span class="keyword">new</span> Receipt();</span><br><span class="line">        receipt.printTitle();</span><br><span class="line">        receipt.print(<span class="string">"Jack's Magic Beans"</span>, <span class="number">4</span>, <span class="number">4.25</span>);</span><br><span class="line">        receipt.print(<span class="string">"Princess Peas"</span>, <span class="number">5</span>, <span class="number">5.1</span>);</span><br><span class="line">        receipt.print(<span class="string">"Three Bears Porridge"</span>, <span class="number">1</span>, <span class="number">14.29</span>);</span><br><span class="line">        receipt.printTotal();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">Item              Qty      Price</span></span><br><span class="line"><span class="comment">- - - -         - - -  - - - - -</span></span><br><span class="line"><span class="comment">Jack's Magic Be     4       4.25</span></span><br><span class="line"><span class="comment">Princess Peas       5       5.10</span></span><br><span class="line"><span class="comment">Three Bears Por     1      14.29</span></span><br><span class="line"><span class="comment">Tax                        23.70</span></span><br><span class="line"><span class="comment">                       - - - - -</span></span><br><span class="line"><span class="comment">Total                      25.06</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Formatter转换表格<br>|     符号    |    定义    |<br>|:———-:|:———-:|<br>| d      | 整数型（十进制） |<br>| c      | Uncode字符 |<br>| b      | Boolean值 |<br>| s      | String |<br>| f      | 浮点数（十进制） |<br>| e      | 浮点数（科学计数） |<br>| x      | 整数（十六进制） |<br>| h      | 散列码（十六进制） |<br>| %      | 字符“%” |</p>
<h3 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h3><p>正则表达式<br>使用Pattern和Matcher实现正则表达式</p>
<p>这里列了正则表达式简单的表格，详细的可以在网上找找教程。</p>
<p>Matcher.find()用来查找多个匹配，可以像迭代器一样不断向前搜索匹配的字符串。</p>
<p>组是用括号划分的正则表达式，可以根据组的编号来引用某个组，组号为0表示整个表达式，组号1表示被第一对括号括起的组，依次类推。比如说：A(B(C))D有三个组<br>组0是ABCD，组1是BC，组2是C。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Groups</span> </span>&#123;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">final</span> String POEM =</span><br><span class="line"><span class="string">"Twas brillig, and the slithy toves\n"</span> +</span><br><span class="line"><span class="string">"Did gyre and gimble in the wabe.\n"</span> +</span><br><span class="line"><span class="string">"All mimsy were the borogoves,\n"</span> +</span><br><span class="line"><span class="string">"And the mome raths outgrabe.\n\n"</span> +</span><br><span class="line"><span class="string">"Beware the Jabberwock, my son,\n"</span> +</span><br><span class="line"><span class="string">"The jaws that bite, the claws that catch.\n"</span> +</span><br><span class="line"><span class="string">"Beware the Jubjub bird, and shun\n"</span> +</span><br><span class="line"><span class="string">"The frumious Bandersnatch."</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Matcher m =</span><br><span class="line">                Pattern.compile(<span class="string">"(?m)(\\S+)\\s+((\\S+)\\s+(\\S+))$"</span>)</span><br><span class="line">                        .matcher(POEM);</span><br><span class="line"><span class="keyword">while</span>(m.find()) &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m.groupCount(); j++)</span><br><span class="line">                System.out.println(<span class="string">"["</span> + m.group(j) + <span class="string">"]"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[the slithy toves]</span></span><br><span class="line"><span class="comment">[the]</span></span><br><span class="line"><span class="comment">[slithy toves]</span></span><br><span class="line"><span class="comment">[slithy]</span></span><br><span class="line"><span class="comment">[toves]</span></span><br><span class="line"><span class="comment">[in the wabe.]</span></span><br><span class="line"><span class="comment">[in]</span></span><br><span class="line"><span class="comment">[the wabe.]</span></span><br><span class="line"><span class="comment">[the]</span></span><br><span class="line"><span class="comment">[wabe.]</span></span><br><span class="line"><span class="comment">[were the borogoves,]</span></span><br><span class="line"><span class="comment">[were]</span></span><br><span class="line"><span class="comment">[the borogoves,]</span></span><br><span class="line"><span class="comment">[the]</span></span><br><span class="line"><span class="comment">[borogoves,]</span></span><br><span class="line"><span class="comment">[mome raths outgrabe.]</span></span><br><span class="line"><span class="comment">[mome]</span></span><br><span class="line"><span class="comment">[raths outgrabe.]</span></span><br><span class="line"><span class="comment">[raths]</span></span><br><span class="line"><span class="comment">[outgrabe.]</span></span><br><span class="line"><span class="comment">[Jabberwock, my son,]</span></span><br><span class="line"><span class="comment">[Jabberwock,]</span></span><br><span class="line"><span class="comment">[my son,]</span></span><br><span class="line"><span class="comment">[my]</span></span><br><span class="line"><span class="comment">[son,]</span></span><br><span class="line"><span class="comment">[claws that catch.]</span></span><br><span class="line"><span class="comment">[claws]</span></span><br><span class="line"><span class="comment">[that catch.]</span></span><br><span class="line"><span class="comment">[that]</span></span><br><span class="line"><span class="comment">[catch.]</span></span><br><span class="line"><span class="comment">[bird, and shun]</span></span><br><span class="line"><span class="comment">[bird,]</span></span><br><span class="line"><span class="comment">[and shun]</span></span><br><span class="line"><span class="comment">[and]</span></span><br><span class="line"><span class="comment">[shun]</span></span><br><span class="line"><span class="comment">[The frumious Bandersnatch.]</span></span><br><span class="line"><span class="comment">[The]</span></span><br><span class="line"><span class="comment">[frumious Bandersnatch.]</span></span><br><span class="line"><span class="comment">[frumious]</span></span><br><span class="line"><span class="comment">[Bandersnatch.]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>Matcher的详细用法，推荐看看这篇博文<br><a href="http://www.itzhai.com/java-notes-regex-matches-and-lookingat.html" target="_blank" rel="noopener">http://www.itzhai.com/java-notes-regex-matches-and-lookingat.html</a></p>
<h2 id="第十四章（类型信息）"><a href="#第十四章（类型信息）" class="headerlink" title="第十四章（类型信息）"></a>第十四章（类型信息）</h2><p>运行时类型信息使得你可以在程序运行时发现和使用类型信息。</p>
<p>RTTI：RunTime Type Identification.</p>
<h3 id="Class类"><a href="#Class类" class="headerlink" title="Class类"></a>Class类</h3><p>类是程序的一部分，每个类都有一个Class对，每一个类都会被保存在一个同名的.class文件中。</p>
<p>所有的类都是在对其第一次使用时，动态加载到JVM中的。static初始化是在类加载时进行的。此时类加载器就会去检查这个类的Class是否被加载。</p>
<p>Class类包含很多有用的方法：（所有Class对象都属于这个类）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">""</span>):<span class="comment">//取得Class对象引用的一种方法。</span></span><br><span class="line">Class cc;</span><br><span class="line">cc.getName();<span class="comment">//获取全限定的类名</span></span><br><span class="line">cc.isInterface();<span class="comment">//是否表示为接口</span></span><br><span class="line">cc.getSimpleName();<span class="comment">//不含包名的类名</span></span><br><span class="line">cc.getInterfaces();<span class="comment">//返回Class对象，表示cc对象中包含的接口</span></span><br><span class="line">cc.getSuperclass();<span class="comment">//查询基类</span></span><br><span class="line">cc.newInstasnce();<span class="comment">//实现“虚拟构造器”来创建自己</span></span><br></pre></td></tr></table></figure>

<p>使用 .class 来创建对Class对象的引用。此时并不会初始化该对象，初始化被延迟到了对静态方法（构造器隐式的是静态的）或非常熟静态域进行首次引用时才执行。</p>
<h3 id="类使用"><a href="#类使用" class="headerlink" title="类使用"></a>类使用</h3><p>类使用的三个步骤：<br>1、加载，由类加载器执行，查找字节码，并从这些字节码中创建一个Class对象。<br>2、链接，验证类中的字节码，为静态域分配存储空间<br>3、初始化，执行静态初始化器和静态初始化块（包括超类）</p>
<h3 id="静态常量"><a href="#静态常量" class="headerlink" title="静态常量"></a>静态常量</h3><p>如果一个 static final 值是 “编译期常量”（像 static final int Y = 1），那么这个值不需要对这个类进行初始化就可以被读取。但是，如果static final 是一个非常数静态域还是会进行类的初始化。</p>
<p>如果一个static 域不是 final的，那么访问前必须先进行链接和初始化行为。</p>
<p>可以使用Class&lt;?&gt; 和 Class&lt;? extends 具体类&gt; 来限制类型，提供编译期的检查。</p>
<p>利用 instanceif 在类型转换前进行检查</p>
<h3 id="Java之外观模式（Facade-Pattern）"><a href="#Java之外观模式（Facade-Pattern）" class="headerlink" title="Java之外观模式（Facade Pattern）"></a>Java之外观模式（Facade Pattern）</h3><p>1.概念<br>为子系统中的一组接口提供一个统一接口。Facade模式定义了一个高层接口，这个接口使得这子系统更容易使用。</p>
<p>2.代码<br>下面是一个具体案例的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> facade;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DrawerOne</span> </span>&#123;  </span><br><span class="line"><span class="function">publicvoid <span class="title">open</span><span class="params">()</span></span>&#123;  </span><br><span class="line">       System.out.println(<span class="string">"第一个抽屉被打开了"</span>);  </span><br><span class="line">       getKey();  </span><br><span class="line">    &#125;  </span><br><span class="line"><span class="function">publicvoid <span class="title">getKey</span><span class="params">()</span></span>&#123;  </span><br><span class="line">       System.out.println(<span class="string">"得到第二个抽屉的钥匙"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DrawerTwo</span></span>&#123;  </span><br><span class="line"><span class="function">publicvoid <span class="title">open</span><span class="params">()</span></span>&#123;  </span><br><span class="line">       System.out.println(<span class="string">"第二个抽屉被打开了"</span>);  </span><br><span class="line">       getFile();  </span><br><span class="line">    &#125;  </span><br><span class="line"><span class="function">publicvoid <span class="title">getFile</span><span class="params">()</span></span>&#123;  </span><br><span class="line">       System.out.println(<span class="string">"得到这个重要文件"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DrawerFacade</span></span>&#123;  </span><br><span class="line">    DrawerOne darwerOne=<span class="keyword">new</span> DrawerOne();  </span><br><span class="line">    DrawerTwo darwerTwo=<span class="keyword">new</span> DrawerTwo();  </span><br><span class="line"><span class="function">publicvoid <span class="title">open</span><span class="params">()</span></span>&#123;  </span><br><span class="line">       darwerOne.open();  </span><br><span class="line">       darwerTwo.open();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">publicclass DrawerClient&#123;  </span><br><span class="line"><span class="function">publicstaticvoid <span class="title">main</span><span class="params">(String []args)</span></span>&#123;  </span><br><span class="line">       DrawerFacade drawer=<span class="keyword">new</span> DrawerFacade();  </span><br><span class="line">       drawer.open();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4.应用场景<br>1）为一个复杂子系统提供一个简单接口。<br>2）提高子系统的独立性。<br>3）在层次化结构中，可以使用Facade模式定义系统中每一层的入口。</p>
<h3 id="RTTI和反射的区别"><a href="#RTTI和反射的区别" class="headerlink" title="RTTI和反射的区别"></a>RTTI和反射的区别</h3><p>RTTI和反射的根本区别：<br>RTTI是在编译时打开和检查.class文件，而对于反射来说.class文件在编译时期是不可获取的，所以是在运行时打开和检查.class文件</p>
<h3 id="class内部方法"><a href="#class内部方法" class="headerlink" title="class内部方法"></a>class内部方法</h3><p>利用Class的getMethods()和getConstructors()方法获得对象的方法和构造器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShowMethods</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Pattern p = Pattern.compile(<span class="string">"\\w+\\."</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; c = Class.forName(<span class="string">"chapter13.Groups"</span>);</span><br><span class="line">            Method[] methods = c.getMethods();</span><br><span class="line">            Constructor[] ctors = c.getConstructors();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (Method method : methods)</span><br><span class="line">print(</span><br><span class="line">p.matcher(method.toString()).replaceAll(<span class="string">""</span>));</span><br><span class="line"><span class="keyword">for</span> (Constructor ctor : ctors)</span><br><span class="line">print(p.matcher(ctor.toString()).replaceAll(<span class="string">""</span>));</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">print(<span class="string">"No such class: "</span> + e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">     public static void main(String[])</span></span><br><span class="line"><span class="comment">     public final void wait() throws InterruptedException</span></span><br><span class="line"><span class="comment">     public final void wait(long,int) throws InterruptedException</span></span><br><span class="line"><span class="comment">     public final native void wait(long) throws InterruptedException</span></span><br><span class="line"><span class="comment">     public boolean equals(Object)</span></span><br><span class="line"><span class="comment">     public String toString()</span></span><br><span class="line"><span class="comment">     public native int hashCode()</span></span><br><span class="line"><span class="comment">     public final native Class getClass()</span></span><br><span class="line"><span class="comment">     public final native void notify()</span></span><br><span class="line"><span class="comment">     public final native void notifyAll()</span></span><br><span class="line"><span class="comment">     public Groups()</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h3><p>使用代理角色来操作真实角色，并对外声明统一接口。</p>
<p>比如说操作数据库，我们可以声明代理类，实现数据库的增删改查操作。</p>
<p>所谓代理模式就是让使用者与真实对象耦合开来，使用代理者来做中间沟通。比如说一个消费者购买商品，其中商店就是代理者，生产商就是真实对象，但消费者和生产商其实并没有联系。</p>
<p>真实角色和代理角色继承同一个接口，代理角色调用真实角色，使用者调用真实角色。</p>
<h3 id="反射修改"><a href="#反射修改" class="headerlink" title="反射修改"></a>反射修改</h3><p>人类已经无法阻止反射了。。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调用method方法</span></span><br><span class="line">Method g = a.getClass().getDeclaredMethod(methodname);</span><br><span class="line">g.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">g.invoke(a);</span><br><span class="line"></span><br><span class="line"><span class="comment">//修改field值</span></span><br><span class="line">Field f = pf.getClass().getDeclaredField(fieldname);</span><br><span class="line">f.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">f.set(pf,<span class="string">""</span>);<span class="comment">// or</span></span><br><span class="line">f.setInt(pf,<span class="number">233</span>);</span><br></pre></td></tr></table></figure>

<p>但final域是安全的，不会遭到修改。</p>
<h2 id="第十五章（泛型）"><a href="#第十五章（泛型）" class="headerlink" title="第十五章（泛型）"></a>第十五章（泛型）</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>泛型的核心概念：告诉编译器想使用什么类型，然后编译器帮你处理一切细节。</p>
<h3 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h3><p>利用泛型创建元组，可以将一组对象直接打包存储于其中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TwoTuple</span>&lt;<span class="title">A</span>, <span class="title">B</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> A first;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> B second;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TwoTuple</span><span class="params">(A a, B b)</span> </span>&#123;</span><br><span class="line">        first = a;</span><br><span class="line">        second = b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"("</span> + first + <span class="string">", "</span> + second + <span class="string">")"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以使用继承机制实现长度更长的元组。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreeTuple</span>&lt;<span class="title">A</span>,<span class="title">B</span>,<span class="title">C</span>&gt; <span class="keyword">extends</span> <span class="title">TwoTuple</span>&lt;<span class="title">A</span>,<span class="title">B</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> C third;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreeTuple</span><span class="params">(A a, B b, C c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(a, b);</span><br><span class="line">        third = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"("</span> + first + <span class="string">", "</span> + second + <span class="string">", "</span> + third +<span class="string">")"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="局限1"><a href="#局限1" class="headerlink" title="局限1"></a>局限1</h3><p>基本类型不能作为泛型的类型参数</p>
<h3 id="泛型方法"><a href="#泛型方法" class="headerlink" title="泛型方法"></a>泛型方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(T a)</span> </span>&#123;</span><br><span class="line">        System.out.println(a.getClass().getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="局限2-擦除"><a href="#局限2-擦除" class="headerlink" title="局限2-擦除"></a>局限2-擦除</h3><p>在泛型代码内部，无法获得任何有关泛型参数类型的信息。<br>在c++中，当模板被实例化时，模板代码知道其模板参数的类型。java泛型由于擦除局限存在无法做到，所以必须利用&lt;? extends &gt;来限定边界以便实现。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">class</span> <span class="title">Manipulator</span> &#123;</span></span><br><span class="line">  T obj;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  Manipulator(T x) &#123; obj = x; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">manipulate</span><span class="params">()</span> </span>&#123; obj.f(); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HasF</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; <span class="built_in">cout</span> &lt;&lt; <span class="string">"HasF::f()"</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  HasF hf;</span><br><span class="line">  Manipulator&lt;HasF&gt; manipulator(hf);</span><br><span class="line">  manipulator.manipulate();</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">HasF::f()</span></span><br><span class="line"><span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<p>在java中实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manipulator2</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">HasF</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> T obj;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Manipulator2</span><span class="params">(T x)</span> </span>&#123; obj = x; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">manipulate</span><span class="params">()</span> </span>&#123; obj.f(); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>“?”代表未知类型</p>
<p>extends关键字声明了类型的上界，表示参数化的类型可能是所指定的类型，或者是此类型的子类</p>
<p>super关键字声明了类型的下界，表示参数化的类型可能是所指定的类型，或者是此类型的父类型，直至Object</p>
<h3 id="参数化接口"><a href="#参数化接口" class="headerlink" title="参数化接口"></a>参数化接口</h3><p>一个类不能实现同一个泛型接口的两种泛型，由于擦除的特性，这两个接口变体会被视为相同的接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//: generics/MultipleInterfaceVariants.java</span></span><br><span class="line"><span class="comment">// &#123;CompileTimeError&#125; (Won't compile)</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Payable</span>&lt;<span class="title">T</span>&gt; </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">Payable</span>&lt;<span class="title">Employee</span>&gt; </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hourly</span> <span class="keyword">extends</span> <span class="title">Employee</span></span></span><br><span class="line"><span class="class">  <span class="keyword">implements</span> <span class="title">Payable</span>&lt;<span class="title">Hourly</span>&gt; </span>&#123;&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<p>同时重载，转型等也会受到影响。</p>
<h3 id="装饰器模式"><a href="#装饰器模式" class="headerlink" title="装饰器模式"></a>装饰器模式</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><ol>
<li><p>又名包装(Wrapper)模式，装饰模式以对客户端透明的方式扩展对象的功能，是继承关系的一个替代方案。</p>
</li>
<li><p>装饰模式以对客户端透明的方式动态的给一个对象附加上更多的责任。换言之客户端并不会觉的对象在装饰前和装饰后有什么区别。</p>
</li>
<li><p>装饰模式可以在不创造更多的子类的模式下，将对象的功能加以扩展。</p>
</li>
<li><p>装饰模式与类继承的区别：</p>
<p>  4-1. 装饰模式是一种动态行为，对已经存在类进行随意组合，而类的继承是一种静态的行为，一个类定义成什么样的，该类的对象便具有什么样的功能，无法动态的改变。</p>
<p>  4-2.  装饰模式扩展的是对象的功能，不需要增加类的数量，而类继承扩展是类的功能，在继承的关系中，如果我们想增加一个对象的功能，我们只能通过继承关系，在子类中增加两个方法。</p>
<p>  4-3. 装饰模式是在不改变原类文件和使用继承的情况下，动态的扩展一个对象的功能，它是通过创建一个包装对象，也就是装饰来包裹真是的对象。</p>
</li>
<li><p>装饰模式把对客户端的调用委派给被装饰的类，装饰模式的关键在于这种扩展完全透明的。</p>
</li>
</ol>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><p>1．　装饰对象和真实对象具有相同的接口，这样客户端对象就可以以真实对象的相同的方式和装饰对象交互。</p>
<p>2．　装饰对象包含一个真实对象的引用(reference).</p>
<p>3．　装饰对象接受所有来自客户端的请求，它把这些请求转发给真实的对象。</p>
<p>4．  装饰对象可以在转发这些请求以前或者以后增加一些附加的功能。这样就能确保在运行时，不用修改给定对象结构就可以在外部增加附加的功能。在面向对象的程序设计中，通常是使用继承的关系来扩展给定类的功能。</p>
<p><strong>tip:使用代理模式，代理和真实对象之间的的关系通常在编译时就已经确定了，而装饰者能够在运行时递归地被构造。</strong></p>
<h3 id="潜在类型机制"><a href="#潜在类型机制" class="headerlink" title="潜在类型机制"></a>潜在类型机制</h3><p>上面说到的c++在编译时期检查参数类型，以及python运行时期检查参数类型，所以可以判断类型。这就形成了潜在类型机制。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Arf!"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sit</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Sitting"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reproduce</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Robot</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> “Click!”;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sit</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Clank"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">oilChange</span><span class="params">(self)</span></span></span><br><span class="line"><span class="function">        <span class="title">pass</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">perform</span><span class="params">(anything)</span>:</span></span><br><span class="line">    anything.speak()</span><br><span class="line">    anything.sit()</span><br><span class="line">    </span><br><span class="line">a = Dog()</span><br><span class="line">b = Robot()</span><br><span class="line">perform(a)</span><br><span class="line">perform(b)</span><br></pre></td></tr></table></figure>

<h2 id="第十六章（数组）"><a href="#第十六章（数组）" class="headerlink" title="第十六章（数组）"></a>第十六章（数组）</h2><h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><p>数组是一个简单的线性序列，访问速度快，但数组对象的大小被固定。</p>
<p>数组的初始化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BerylliumSphere[] a; <span class="comment">// Local uninitialized variable</span></span><br><span class="line">a = <span class="keyword">new</span> BerylliumSphere[]&#123;</span><br><span class="line">        <span class="keyword">new</span> BerylliumSphere(), <span class="keyword">new</span> BerylliumSphere(),&#125;;</span><br><span class="line">BerylliumSphere[] b = <span class="keyword">new</span> BerylliumSphere[<span class="number">5</span>];</span><br><span class="line">BerylliumSphere[] d = &#123;<span class="keyword">new</span> BerylliumSphere(),</span><br><span class="line">        <span class="keyword">new</span> BerylliumSphere(), <span class="keyword">new</span> BerylliumSphere()&#125;;</span><br></pre></td></tr></table></figure>

<p>对象数组保存的是引用，基本类型数组是直接保存基本类型的值。</p>
<h3 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h3><p>粗糙数组：数组中构成矩阵的每个向量都可以具有任意的长度。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RaggedArray</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line">        <span class="comment">// 3-D array with varied-length vectors:</span></span><br><span class="line">        <span class="keyword">int</span>[][][] a = <span class="keyword">new</span> <span class="keyword">int</span>[rand.nextInt(<span class="number">7</span>)][][];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">            a[i] = <span class="keyword">new</span> <span class="keyword">int</span>[rand.nextInt(<span class="number">5</span>)][];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; a[i].length; j++)</span><br><span class="line">                a[i][j] = <span class="keyword">new</span> <span class="keyword">int</span>[rand.nextInt(<span class="number">5</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">    System.out.println(Arrays.deepToString(a));</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">[[], [[0], [0], [0, 0, 0, 0]], [[], [0, 0], [0, 0]], [[0, 0, 0], [0], [0, 0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0], []], [[0], [], [0]]]</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### deepToString</span><br><span class="line">Arrays.deepTotring()可以输出数组，对象数组和基本类型数组都其作用。</span><br><span class="line"></span><br><span class="line">### fill()</span><br><span class="line">Arrays.fill() 可以用数字填充数组。</span><br><span class="line"></span><br><span class="line">### 常用数组操作</span><br><span class="line">* **System.arraycopy()** 用于复制数组，注意这只是浅复制。</span><br><span class="line">* **Arrays.equals()** 用来比较数组是否相等，两者个数不仅相等，且每个位置上的每个元素都要相等。</span><br><span class="line">* **Comparable** 利用此接口进行比较，compareTo()方法中，当前对象小于参数返回负值，等于返回零。</span><br><span class="line">* **Arrays.sort()** 进行排序，前提是数组内对象实现了Comparable 接口。使用内置的排序方法，可以对任意的基本类型数组排序。</span><br><span class="line">```java</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringSorting</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String[] sa = Generated.array(<span class="keyword">new</span> String[<span class="number">20</span>],</span><br><span class="line">      <span class="keyword">new</span> RandomGenerator.String(<span class="number">5</span>));</span><br><span class="line">    print(<span class="string">"Before sort: "</span> + Arrays.toString(sa));</span><br><span class="line">    Arrays.sort(sa);<span class="comment">//字典排序，大写排在小写前面</span></span><br><span class="line">    print(<span class="string">"After sort: "</span> + Arrays.toString(sa));</span><br><span class="line">    Arrays.sort(sa, Collections.reverseOrder());<span class="comment">//反向</span></span><br><span class="line">    print(<span class="string">"Reverse sort: "</span> + Arrays.toString(sa));</span><br><span class="line">    Arrays.sort(sa, String.CASE_INSENSITIVE_ORDER);忽略大小写</span><br><span class="line">    print(<span class="string">"Case-insensitive sort: "</span> + Arrays.toString(sa));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Arrays.binarySearch()</strong> 排序后才可以使用该方法进行快速查找。找到目标返回值，大于等于零，否则返回负值。负值 = -（插入点）-1；<br>若使用了自定义的Comparable,则需要将Comparable作为参数传入方法中。</p>
<p><strong>优先使用容器而不是数组</strong></p>
<h2 id="第十七章（容器深入研究）"><a href="#第十七章（容器深入研究）" class="headerlink" title="第十七章（容器深入研究）"></a>第十七章（容器深入研究）</h2><p><img src="http://images.cnitblog.com/blog/685583/201411/091813238311297.png" alt="java容器"></p>
<p>除此以外还添加了 queue , ConcurrentMap  接口以及相应实现的 <strong>PriorityQueue</strong>,<strong>BlockingQueue</strong> 和 <strong>ConcurrentHashMap</strong>等容器。<br>同时在 <strong>Collections</strong> 类中有着对容器进行操作方便的方法。</p>
<p>Collection是集合类的上级接口，子接口主要有Set 和List、Map。Collections是针对集合类的一个帮助类，提供了操作集合的工具方法：一系列静态方法实现对各种集合的搜索、排序、线程安全化等操作。</p>
<h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><p>retainAll()方法:取得两个List的交集</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list1 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">List&lt;String&gt; list2 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">list1.add(<span class="string">"g"</span>);</span><br><span class="line">list1.add(<span class="string">"s"</span>);</span><br><span class="line">list1.add(<span class="string">"a"</span>);</span><br><span class="line">list1.add(<span class="string">"f"</span>);</span><br><span class="line">list2.add(<span class="string">"g"</span>);</span><br><span class="line">list2.add(<span class="string">"c"</span>);</span><br><span class="line">list2.add(<span class="string">"b"</span>);</span><br><span class="line">list2.add(<span class="string">"a"</span>);</span><br><span class="line">list1.retainAll(list2);</span><br><span class="line">System.out.print(list1);</span><br><span class="line"><span class="comment">//[g, a]</span></span><br></pre></td></tr></table></figure>

<p><code>ListIterator.add()</code>方法<br>把新元素插入由next()所返回的那个元素之前，previous()所返回的元素之后</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; alpha = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">alpha.add(<span class="string">"a"</span>);</span><br><span class="line">alpha.add(<span class="string">"b"</span>);</span><br><span class="line">alpha.add(<span class="string">"c"</span>);</span><br><span class="line">alpha.add(<span class="string">"d"</span>);</span><br><span class="line">alpha.add(<span class="string">"e"</span>);</span><br><span class="line"></span><br><span class="line">ListIterator&lt;String&gt; listIterator = alpha.listIterator();</span><br><span class="line">listIterator.next();</span><br><span class="line">listIterator.add(<span class="string">"1"</span>);</span><br><span class="line">listIterator.add(<span class="string">"2"</span>);</span><br><span class="line">System.out.println(alpha.toString());</span><br><span class="line">listIterator.next();</span><br><span class="line">listIterator.add(<span class="string">"3"</span>);</span><br><span class="line">System.out.println(alpha.toString())</span><br></pre></td></tr></table></figure>

<h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>存入 Set 的每个元素都必须是唯一的，因为Set不保存重复元素。加入Set的元素必须定义equal()方法以确保对象的唯一性。<br><code>HashSet</code> 为快速查找而设计的Set,存入HashSet的元素必须定义hashCode()<br><code>TreeSet</code> 保持次序的Set,底层为树结构，使用它可以从Set中提取有序的序列，元素必须实现Comparable接口<br><code>LinkedHashSet</code> 具有HashSet的查询速度，且内部使用链表维护元素的顺序，元素也必须定义hashCode()方法</p>
<h3 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h3><p><code>LinkedList</code> 和 <code>PriorityQueue</code><br>其他的还有<br><code>ArrayBlockingQueue</code>,<code>ConcurrentLinkedQueue</code>,<code>LinkedBlockingQueue</code>,<code>PriorityBlockingQueue</code>。</p>
<p>优先级队列<code>PriorityQueue</code> 需要元素继承 Comparable 接口。返回+,表示被比较的排在当前的后面，0表示相等，返回-则相反</p>
<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>Map中最重要的是用散列码代替对象的int值，散列表是通过将对象的某些信息进行转换而生成。hashCode()是根类Object中的方法，而HashMap就是使用对象的hashCode()进行快速查询。<br>任何键都必须具有一个equals()方法，如果键被用于散列Map,则必须具有恰当的hashCode()方法，如果用于TreeMap，还必须实现Compareable。</p>
<p><strong>注意</strong>：基本常量，特别是new String()，看上去像是生成了一个新的对象，但内存地址可能是一样的。</p>
<p>通过一个特定容量的数组来保存键，但不是保存键本身，而是通过键对象生成的一个数字，将这个数字作为数组的下标，而数组本身是保存值的list。这样我们就可以通过键对象的hashCode获得数组的下标，根据下标找到保存在数组里值list的位置，再通过对象的equals方法去线性比较list的值。</p>
<h3 id="容器选择"><a href="#容器选择" class="headerlink" title="容器选择"></a>容器选择</h3><p>ArrayList便于查询，内部使用数组实现。因为增加的时候会涉及到扩容，会导致数值的复制操作所以效率低。<br>LinkedList便于增加和删除</p>
<p>HashSet的性能基本上总是比TreeSet好，特别是添加和查询元素时，而需要排序功能时才会考虑使用TreeSet</p>
<p>HashMap是第一选择，需要排序时使用TreeMap,而需要保持插入顺序时使用LinkedHashMap</p>
<p><code>负载因子</code> 尺寸/容量</p>
<h3 id="同步控制"><a href="#同步控制" class="headerlink" title="同步控制"></a>同步控制</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Collections.synchronizedList(<span class="keyword">new</span> ArrayList&lt;String&gt;());</span><br><span class="line"><span class="comment">//其他容器同理</span></span><br></pre></td></tr></table></figure>

<p>直接将新生成的容器容器传递给了适当的“同步”方法，这样就不会有任何机会暴露出不同步的版本。</p>
<h3 id="持有引用"><a href="#持有引用" class="headerlink" title="持有引用"></a>持有引用</h3><p>普通的引用即为强引用，GC不会回收。</p>
<p><strong>SoftReference</strong><br>软引用是当内存不足时GC回收，构建缓存系统</p>
<p><strong>WeakReference</strong><br>弱引用是每次GC时都会回收，减少人工清理引用<br>WeakHashMap被用来保存weakReference</p>
<p>虚引用在监视垃圾回收时使用</p>
<h2 id="第十八章（Java-IO-系统）"><a href="#第十八章（Java-IO-系统）" class="headerlink" title="第十八章（Java IO 系统）"></a>第十八章（Java IO 系统）</h2><h3 id="File"><a href="#File" class="headerlink" title="File"></a>File</h3><p><strong>File 不仅代表一个特定文件的名称，也能代表一个目录下的一组文件的名称</strong></p>
<p>File的list()方法可以传入 <code>FilenameFilter()</code>对文件进行筛选。<br>renameTo()用来把一个文件重命名（或移动）到由参数所指示的另一个完全不同的新路径（也就是另一个File对象）下面。<br>mkdirs()可以产生任意复杂的目录路径。</p>
<h3 id="I-O"><a href="#I-O" class="headerlink" title="I/O"></a>I/O</h3><table>
<thead>
<tr>
<th>字节流类</th>
<th>功能简单介绍</th>
</tr>
</thead>
<tbody><tr>
<td>DataInputStream</td>
<td>包含了读取Java标准数据类型的输入流</td>
</tr>
<tr>
<td>DataOutputStream</td>
<td>包含了写Java标准数据类型的输出流</td>
</tr>
<tr>
<td>ByteArrayInputStream</td>
<td>从字节数组读取的输入流</td>
</tr>
<tr>
<td>ByteArrayOutputStream</td>
<td>写入字节数组的输出流</td>
</tr>
<tr>
<td>FileInputStream</td>
<td>从文件读入的输入流</td>
</tr>
<tr>
<td>FileOutputStream</td>
<td>写入文件的输出流</td>
</tr>
<tr>
<td>PrintStream</td>
<td>包含最常见的Print（）和Println（）的输出流</td>
</tr>
<tr>
<td>PushbackInputStream</td>
<td>返回一个字节到输入流，主要用于编译器的实现</td>
</tr>
<tr>
<td>PipedOutputStream</td>
<td>输入管道</td>
</tr>
<tr>
<td>SequenceInputStream</td>
<td>将n个输入流联合起来，一个接一个按一定顺序读取</td>
</tr>
<tr>
<td>RandomAccessFile</td>
<td>随机访问文件</td>
</tr>
<tr>
<td>BufferInputStream</td>
<td>缓冲输入流</td>
</tr>
<tr>
<td>BufferOutputStream</td>
<td>缓冲输出流</td>
</tr>
<tr>
<td>FilterInputStream</td>
<td>实现了InputStream Interface</td>
</tr>
<tr>
<td>FilterOutputStream</td>
<td>实现了OutputStream Interface</td>
</tr>
<tr>
<td>InputStream</td>
<td>抽象类，描述流的输入</td>
</tr>
<tr>
<td>OutputStream</td>
<td>抽象类，描述流的输入</td>
</tr>
</tbody></table>
<h3 id="使用RandomAccessFile写入文件"><a href="#使用RandomAccessFile写入文件" class="headerlink" title="使用RandomAccessFile写入文件"></a>使用RandomAccessFile写入文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String fileName=<span class="string">"D:"</span>+File.separator+<span class="string">"hello.txt"</span>;</span><br><span class="line">        File f=<span class="keyword">new</span> File(fileName);</span><br><span class="line">        RandomAccessFile demo=<span class="keyword">new</span> RandomAccessFile(f,<span class="string">"rw"</span>);</span><br><span class="line">        demo.writeBytes(<span class="string">"asdsad"</span>);</span><br><span class="line">        demo.writeInt(<span class="number">12</span>);</span><br><span class="line">        demo.writeBoolean(<span class="keyword">true</span>);</span><br><span class="line">        demo.writeChar(<span class="string">'A'</span>);</span><br><span class="line">        demo.writeFloat(<span class="number">1.21f</span>);</span><br><span class="line">        demo.writeDouble(<span class="number">12.123</span>);</span><br><span class="line">        demo.close();  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="关于字节流和字符流的区别"><a href="#关于字节流和字符流的区别" class="headerlink" title="关于字节流和字符流的区别"></a>关于字节流和字符流的区别</h3><p>实际上字节流在操作的时候本身是不会用到缓冲区的，是文件本身的直接操作的，但是字符流在操作的 时候下后是会用到缓冲区的，是通过缓冲区来操作文件的。</p>
<p>读者可以试着将上面的字节流和字符流的程序的最后一行关闭文件的代码注释掉，然后运行程序看看。你就会发现使用字节流的话，文件中已经存在内容，但是使用字符流的时候，文件中还是没有内容的，这个时候就要刷新缓冲区。</p>
<h3 id="OutputStreramWriter-和-InputStreamReader"><a href="#OutputStreramWriter-和-InputStreamReader" class="headerlink" title="OutputStreramWriter 和 InputStreamReader"></a>OutputStreramWriter 和 InputStreamReader</h3><p>OutputStreramWriter将输出的字符流转化为字节流<br>InputStreamReader将输入的字节流转换为字符流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将字节输出流转化为字符输出流</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StreamTest</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String fileName= <span class="string">"d:"</span>+File.separator+<span class="string">"hello.txt"</span>;</span><br><span class="line">        File file=<span class="keyword">new</span> File(fileName);</span><br><span class="line">        Writer out=<span class="keyword">new</span> OutputStreamWriter(<span class="keyword">new</span> FileOutputStream(file));</span><br><span class="line">        out.write(<span class="string">"cpacm"</span>);</span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StreamTest2</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String fileName= <span class="string">"d:"</span>+File.separator+<span class="string">"hello.txt"</span>;</span><br><span class="line">        File file=<span class="keyword">new</span> File(fileName);</span><br><span class="line">        Reader read=<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(file));</span><br><span class="line">        <span class="keyword">char</span>[] b=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">100</span>];</span><br><span class="line">        <span class="keyword">int</span> len=read.read(b);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(b,<span class="number">0</span>,len));</span><br><span class="line">        read.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SequenceInputStream"><a href="#SequenceInputStream" class="headerlink" title="SequenceInputStream"></a>SequenceInputStream</h3><p>SequenceInputStream主要用来将2个流合并在一起，比如将两个txt中的内容合并为另外一个txt。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 合并流</span></span><br><span class="line">SequenceInputStream sis = <span class="keyword">new</span> SequenceInputStream(input1, input2);</span><br></pre></td></tr></table></figure>

<h3 id="java内部执行其他操作系统的程序"><a href="#java内部执行其他操作系统的程序" class="headerlink" title="java内部执行其他操作系统的程序"></a>java内部执行其他操作系统的程序</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OSExecute</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">command</span><span class="params">(String command)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> err = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Process process =</span><br><span class="line">        <span class="keyword">new</span> ProcessBuilder(command.split(<span class="string">" "</span>)).start();</span><br><span class="line">      BufferedReader results = <span class="keyword">new</span> BufferedReader(</span><br><span class="line">        <span class="keyword">new</span> InputStreamReader(process.getInputStream()));</span><br><span class="line">      String s;</span><br><span class="line">      <span class="keyword">while</span>((s = results.readLine())!= <span class="keyword">null</span>)</span><br><span class="line">        System.out.println(s);</span><br><span class="line">      BufferedReader errors = <span class="keyword">new</span> BufferedReader(</span><br><span class="line">        <span class="keyword">new</span> InputStreamReader(process.getErrorStream()));</span><br><span class="line">      <span class="comment">// Report errors and return nonzero value</span></span><br><span class="line">      <span class="comment">// to calling process if there are problems:</span></span><br><span class="line">      <span class="keyword">while</span>((s = errors.readLine())!= <span class="keyword">null</span>) &#123;</span><br><span class="line">        System.err.println(s);</span><br><span class="line">        err = <span class="keyword">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">      <span class="comment">// Compensate for Windows 2000, which throws an</span></span><br><span class="line">      <span class="comment">// exception for the default command line:</span></span><br><span class="line">      <span class="keyword">if</span>(!command.startsWith(<span class="string">"CMD /C"</span>))</span><br><span class="line">        command(<span class="string">"CMD /C "</span> + command);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(err)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> OSExecuteException(<span class="string">"Errors executing "</span> +</span><br><span class="line">        command);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>

<h3 id="NIO"><a href="#NIO" class="headerlink" title="NIO"></a>NIO</h3><p><strong>通道</strong> 和 <strong>缓冲区</strong> 是 NIO 中的核心对象<br>通道是对原 I/O 包中的流的模拟。到任何目的地(或来自任何地方)的所有数据都必须通过一个 Channel 对象。一个 Buffer 实质上是一个容器对象。发送给一个通道的所有对象都必须首先放到缓冲区中；同样地，从通道中读取的任何数据都要读到缓冲区中。通道与流的不同之处在于通道是双向的。而流只是在一个方向上移动(一个流必须是 InputStream 或者 OutputStream 的子类)， 而 通道 可以用于读、写或者同时用于读写。<br>唯一直接与通道交互的缓冲器是ByteBuffer。<br>在<code>FileInputStream</code>,<code>FileOutputStream</code>和<code>RandomAccessFile</code>这三个类中修改，用于产生FileChannel.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Write a file:</span></span><br><span class="line">   FileChannel fc =</span><br><span class="line">     <span class="keyword">new</span> FileOutputStream(<span class="string">"data.txt"</span>).getChannel();</span><br><span class="line">   fc.write(ByteBuffer.wrap(<span class="string">"Some text "</span>.getBytes()));</span><br><span class="line">   fc.close();</span><br><span class="line">   <span class="comment">// Add to the end of the file:</span></span><br><span class="line">   fc =</span><br><span class="line">     <span class="keyword">new</span> RandomAccessFile(<span class="string">"data.txt"</span>, <span class="string">"rw"</span>).getChannel();</span><br><span class="line">   fc.position(fc.size()); <span class="comment">// Move to the end</span></span><br><span class="line">   fc.write(ByteBuffer.wrap(<span class="string">"Some more"</span>.getBytes()));</span><br><span class="line">   fc.close();</span><br><span class="line">   <span class="comment">// Read the file:</span></span><br><span class="line">   fc = <span class="keyword">new</span> FileInputStream(<span class="string">"data.txt"</span>).getChannel();</span><br><span class="line">   ByteBuffer buff = ByteBuffer.allocate(BSIZE);</span><br><span class="line">   fc.read(buff);</span><br><span class="line">   buff.flip();</span><br><span class="line">   <span class="keyword">while</span>(buff.hasRemaining())</span><br><span class="line">     System.out.print((<span class="keyword">char</span>)buff.get());</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>当 buffer 一旦被通道存储数据，就要调用flip()方法做好被读取的准备。<br>clear() 方法重设缓冲区，使它可以接受读入的数据。 flip() 方法让缓冲区可以将新读入的数据写入另一个通道。 </p>
<p>使用<strong>transferTo</strong>和<strong>transferFrom</strong>来将两个通道相通。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetData</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BSIZE = <span class="number">1024</span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ByteBuffer bb = ByteBuffer.allocate(BSIZE);</span><br><span class="line">    <span class="comment">// Allocation automatically zeroes the ByteBuffer:</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i++ &lt; bb.limit())</span><br><span class="line">      <span class="keyword">if</span>(bb.get() != <span class="number">0</span>)</span><br><span class="line">        print(<span class="string">"nonzero"</span>);</span><br><span class="line">    print(<span class="string">"i = "</span> + i);</span><br><span class="line">    bb.rewind();</span><br><span class="line">    <span class="comment">// Store and read a char array:</span></span><br><span class="line">    bb.asCharBuffer().put(<span class="string">"Howdy!"</span>);</span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">while</span>((c = bb.getChar()) != <span class="number">0</span>)</span><br><span class="line">      printnb(c + <span class="string">" "</span>);</span><br><span class="line">    print();</span><br><span class="line">    bb.rewind();</span><br><span class="line">    <span class="comment">// Store and read a short:</span></span><br><span class="line">    bb.asShortBuffer().put((<span class="keyword">short</span>)<span class="number">471142</span>);</span><br><span class="line">    print(bb.getShort());</span><br><span class="line">    bb.rewind();</span><br><span class="line">    <span class="comment">// Store and read an int:</span></span><br><span class="line">    bb.asIntBuffer().put(<span class="number">99471142</span>);</span><br><span class="line">    print(bb.getInt());</span><br><span class="line">    bb.rewind();</span><br><span class="line">    <span class="comment">// Store and read a long:</span></span><br><span class="line">    bb.asLongBuffer().put(<span class="number">99471142</span>);</span><br><span class="line">    print(bb.getLong());</span><br><span class="line">    bb.rewind();</span><br><span class="line">    <span class="comment">// Store and read a float:</span></span><br><span class="line">    bb.asFloatBuffer().put(<span class="number">99471142</span>);</span><br><span class="line">    print(bb.getFloat());</span><br><span class="line">    bb.rewind();</span><br><span class="line">    <span class="comment">// Store and read a double:</span></span><br><span class="line">    bb.asDoubleBuffer().put(<span class="number">99471142</span>);</span><br><span class="line">    print(bb.getDouble());</span><br><span class="line">    bb.rewind();</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">i = 1025</span></span><br><span class="line"><span class="comment">H o w d y !</span></span><br><span class="line"><span class="comment">12390</span></span><br><span class="line"><span class="comment">99471142</span></span><br><span class="line"><span class="comment">99471142</span></span><br><span class="line"><span class="comment">9.9471144E7</span></span><br><span class="line"><span class="comment">9.9471142E7</span></span><br><span class="line"><span class="comment">*/</span><span class="comment">//:~</span></span><br></pre></td></tr></table></figure>

<p>向ByteBuffer插入基本类型数据最简单的方法：利用asCharBuffer()、asShortBuffer等获得该缓冲器上的视图，然后使用视图的put()方法，此适用于所有基本数据类型。（short要进行类型转换）。</p>
<p>具体详情：<br><a href="http://www.ibm.com/developerworks/cn/education/java/j-nio/index.html" target="_blank" rel="noopener">NIO</a></p>
<h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><p><strong>Externalizable</strong>  可用来代替实现 <strong>Serializable</strong> 接口——对序列化过程进行控制。这个 <strong>Externalizable</strong> 接口继承了 <strong>Serializable</strong> 接口，同时增添了两个方法：<code>writeExternal()</code> 和 <code>readExternal()</code>。<br>对于<strong>Serializable</strong>对象，对象完全以它存储的二进制位为基础来构造，而不调用构造器。而对于一个<strong>Externalizable</strong>对象，所有普通的默认构造器都会被调用（包括在字段定义时的初始化），然后调用<code>readExternal()</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Blip</span> <span class="keyword">implements</span> <span class="title">Externalizable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">private</span> String s;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Blip</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"blip construct"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Blip</span><span class="params">(<span class="keyword">int</span> i, String s)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"blip construct with i and s"</span>);</span><br><span class="line">        <span class="keyword">this</span>.i = i;</span><br><span class="line">        <span class="keyword">this</span>.s = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s + i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeExternal</span><span class="params">(ObjectOutput out)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"blip writeExternal"</span>);</span><br><span class="line">        out.writeInt(i);</span><br><span class="line">        out.writeObject(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readExternal</span><span class="params">(ObjectInput in)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"blip readExternal"</span>);</span><br><span class="line">        i = in.readInt();</span><br><span class="line">        s = (String) in.readObject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        Blip blip = <span class="keyword">new</span> Blip(<span class="number">1</span>, <span class="string">"blip"</span>);</span><br><span class="line">        System.out.println(blip);</span><br><span class="line">        ObjectOutputStream o = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"blip.out"</span>));</span><br><span class="line">        o.writeObject(blip);</span><br><span class="line">        o.close();</span><br><span class="line"></span><br><span class="line">        ObjectInputStream in = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"blip.out"</span>));</span><br><span class="line">        Blip blip2 = (Blip) in.readObject();</span><br><span class="line">        System.out.println(blip2);</span><br><span class="line">        in.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    输出：</span></span><br><span class="line"><span class="comment">    blip construct with i and s</span></span><br><span class="line"><span class="comment">    blip1</span></span><br><span class="line"><span class="comment">    blip writeExternal</span></span><br><span class="line"><span class="comment">    blip construct</span></span><br><span class="line"><span class="comment">    blip readExternal</span></span><br><span class="line"><span class="comment">    blip1</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在<code>writeExternal()</code> 和 <code>readExternal()</code>两个方法中数据写入和数据读取的顺序要一致，否则会报<code>OptionalDataException</code>异常</p>
</blockquote>
<p>可以实现Serializable接口，并添加 <strong>writeObjct()</strong> 和<strong>readObject</strong>两个方法（即Externalizable接口下的两个方法），这样一旦对象被序列化或被反序列化还原就会自动地分别调用这两个方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(ObjectOutputStream stream)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(OjectInputStream stream)</span> <span class="keyword">throws</span> IOException,ClassNotFoundException</span></span><br></pre></td></tr></table></figure>

<p>在调用ObjectOutputStream.writeObject()时，会检查所传递的Serializable对象，看看是否实现了它自己的writeObject()。如果是这样，就跳过正常的序列化过程并调用它的writeObject()，readObject()同理。<br>在你的writeObject()内部，可以调用defaultWriteObject()来选择执行默认的writeObject()，此时就等同于常规下的Serializable</p>
<h3 id="transient-瞬时-关键字"><a href="#transient-瞬时-关键字" class="headerlink" title="transient (瞬时)关键字"></a>transient (瞬时)关键字</h3><p>用于控制某个特定子对象不想让Java的序列化机制自动保存于恢复。<br>比如说一个用户对象的密码字段不想被序列化保存下来就可以使用 transient 来声明该字段。</p>
<h3 id="使用“持久化”"><a href="#使用“持久化”" class="headerlink" title="使用“持久化”"></a>使用“持久化”</h3><p>只要将任何对象序列化到单一流中，就可以恢复出与之前写出时一样的对象网，并不会出现重复的对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">House</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> House preferredHouse;</span><br><span class="line">  Animal(String nm, House h) &#123;</span><br><span class="line">    name = nm;</span><br><span class="line">    preferredHouse = h;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name + <span class="string">"["</span> + <span class="keyword">super</span>.toString() +</span><br><span class="line">      <span class="string">"], "</span> + preferredHouse + <span class="string">"\n"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyWorld</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">  <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">    House house = <span class="keyword">new</span> House();</span><br><span class="line">    List&lt;Animal&gt; animals = <span class="keyword">new</span> ArrayList&lt;Animal&gt;();</span><br><span class="line">    animals.add(<span class="keyword">new</span> Animal(<span class="string">"Bosco the dog"</span>, house));</span><br><span class="line">    animals.add(<span class="keyword">new</span> Animal(<span class="string">"Ralph the hamster"</span>, house));</span><br><span class="line">    animals.add(<span class="keyword">new</span> Animal(<span class="string">"Molly the cat"</span>, house));</span><br><span class="line">    print(<span class="string">"animals: "</span> + animals);</span><br><span class="line">    ByteArrayOutputStream buf1 =</span><br><span class="line">      <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">    ObjectOutputStream o1 = <span class="keyword">new</span> ObjectOutputStream(buf1);</span><br><span class="line">    o1.writeObject(animals);</span><br><span class="line">    o1.writeObject(animals); <span class="comment">// Write a 2nd set</span></span><br><span class="line">    <span class="comment">// Write to a different stream:</span></span><br><span class="line">    ByteArrayOutputStream buf2 =</span><br><span class="line">      <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">    ObjectOutputStream o2 = <span class="keyword">new</span> ObjectOutputStream(buf2);</span><br><span class="line">    o2.writeObject(animals);</span><br><span class="line">    <span class="comment">// Now get them back:</span></span><br><span class="line">    ObjectInputStream in1 = <span class="keyword">new</span> ObjectInputStream(</span><br><span class="line">      <span class="keyword">new</span> ByteArrayInputStream(buf1.toByteArray()));</span><br><span class="line">    ObjectInputStream in2 = <span class="keyword">new</span> ObjectInputStream(</span><br><span class="line">      <span class="keyword">new</span> ByteArrayInputStream(buf2.toByteArray()));</span><br><span class="line">    List</span><br><span class="line">      animals1 = (List)in1.readObject(),</span><br><span class="line">      animals2 = (List)in1.readObject(),</span><br><span class="line">      animals3 = (List)in2.readObject();</span><br><span class="line">    print(<span class="string">"animals1: "</span> + animals1);</span><br><span class="line">    print(<span class="string">"animals2: "</span> + animals2);</span><br><span class="line">    print(<span class="string">"animals3: "</span> + animals3);</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">/* Output: (Sample)</span></span><br><span class="line"><span class="comment">animals: [Bosco the dog[Animal@addbf1], House@42e816</span></span><br><span class="line"><span class="comment">, Ralph the hamster[Animal@9304b1], House@42e816</span></span><br><span class="line"><span class="comment">, Molly the cat[Animal@190d11], House@42e816</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">animals1: [Bosco the dog[Animal@de6f34], House@156ee8e</span></span><br><span class="line"><span class="comment">, Ralph the hamster[Animal@47b480], House@156ee8e</span></span><br><span class="line"><span class="comment">, Molly the cat[Animal@19b49e6], House@156ee8e</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">animals2: [Bosco the dog[Animal@de6f34], House@156ee8e</span></span><br><span class="line"><span class="comment">, Ralph the hamster[Animal@47b480], House@156ee8e</span></span><br><span class="line"><span class="comment">, Molly the cat[Animal@19b49e6], House@156ee8e</span></span><br><span class="line"><span class="comment">]</span></span><br><span class="line"><span class="comment">animals3: [Bosco the dog[Animal@10d448], House@e0e1c6</span></span><br><span class="line"><span class="comment">, Ralph the hamster[Animal@6ca1c], House@e0e1c6</span></span><br><span class="line"><span class="comment">, Molly the cat[Animal@1bf216a], House@e0e1c6</span></span><br><span class="line"><span class="comment">]</span></span><br></pre></td></tr></table></figure>

<p><strong>Java序列化是不能序列化static变量的，因为其保存的是对象的状态，而static变量保存在全局数据区，在对象未实例化时就已经生成，属于类的状态。</strong></p>
<h2 id="第十九章（枚举类型）"><a href="#第十九章（枚举类型）" class="headerlink" title="第十九章（枚举类型）"></a>第十九章（枚举类型）</h2><p><strong>在Android避免使用Enum，因为与静态常量相比，它对内存的占用要大很多。</strong></p>
<h3 id="values"><a href="#values" class="headerlink" title="values()"></a>values()</h3><p><code>values()</code>方法是由编译器插入到enum定义的static方法(同时还有<code>valueof()</code>方法)，所以若将enum实例向上转型为Enum,那么values方法就不可访问。不过，在Class中有一个<code>getEnumConstants()</code>方法，即使Enum接口中没有<code>values()</code>方法，我们仍可以通过Class对象取得所有enum实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpcastEnum</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> Sample&#123;TEXT,CONTENT&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Sample[] samples = Sample.values();</span></span><br><span class="line">        Enum e = Sample.TEXT;</span><br><span class="line">        <span class="keyword">for</span>(Enum en :e.getClass().getEnumConstants())&#123;</span><br><span class="line">            System.out.println(en);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    输出：</span></span><br><span class="line"><span class="comment">    TEXT</span></span><br><span class="line"><span class="comment">    CONTENT</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然对于不是枚举的类调用此方法只会返回null.</p>
<h3 id="Enum-泛型使用示例"><a href="#Enum-泛型使用示例" class="headerlink" title="Enum 泛型使用示例"></a>Enum 泛型使用示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Enums</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Random random = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T extends Enum&lt;T&gt;&gt; <span class="function">T <span class="title">random</span><span class="params">(Class&lt;T&gt; ec)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> random(ec.getEnumConstants());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">random</span><span class="params">(T[] values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> values[random.nextInt(values.length)];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">enum</span> Activity &#123;create, start, resume, pause, stop, destroy&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            System.out.print(Enums.random(Activity.class) + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//输出：resume destroy start destroy start destroy stop resume create start</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在一个接口的内部，创建实现该接口的枚举，以此将元素进行分组，可以达到将枚举元素分类组织的目的。</p>
</blockquote>
<h3 id="EnumSet-和-EnumMap"><a href="#EnumSet-和-EnumMap" class="headerlink" title="EnumSet 和 EnumMap"></a>EnumSet 和 EnumMap</h3><p>Enum能说明一个二进制是否存在时，具有更好的表达能力。<br>EnumSet的基础是long,一个long值有64位，而一个enum实例只需一位bit表示其是否存在。</p>
<p>EnumMap要求其中的key必须来自一个enum ,EnumMap 内部由数组实现。</p>
<h2 id="第二十章（注解）"><a href="#第二十章（注解）" class="headerlink" title="第二十章（注解）"></a>第二十章（注解）</h2><p><strong>注解（也被称为元数据）为我们在代码中添加信息提供了一种形式化的方法，使我们可以在稍后某个时刻非常方便的使用这些数据。</strong></p>
<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> UserCase &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">id</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">description</span><span class="params">()</span> <span class="keyword">default</span> "no description"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Target</code> 用来定义你的注解将应用于什么地方，<br><code>@Rectetion</code>用来定义该注解在哪一个级别可用，在源代码（SOURCE）、类文件（CLASS）或者运行时（RUNTIME）.</p>
<table>
<thead>
<tr>
<th>注解</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>@Target</td>
<td>表示该注解可以用于什么地方，可能的ElementType参数包括：<code>CONSTRUCTOR:构造器的声明</code>,<code>FIELD:域声明（包括enum实例）</code>,<code>LOCAL_VARIABLE：局部变量声明</code>,<code>METHOD：方法声明</code>,<code>PACKAGE：包声明</code>,<code>PARAMETER：参数声明</code>,<code>TYPE:类、接口（包括注解类型）或enum声明</code></td>
</tr>
<tr>
<td>@Retention</td>
<td>表示需要在什么级别保存该注解信息。可选的<strong>RetentionPolicy</strong>参数包括：<code>SOURCE:注解将被编译器丢弃</code>,<code>CLASS:注解在class文件中可用，但会被VM丢弃</code>,<code>RUNTIME:VM将在运行期也被保留注解，因此可以通过反射机制读取注解的信息。</code></td>
</tr>
<tr>
<td>@Documented</td>
<td>将此注解包含在Javadoc中</td>
</tr>
<tr>
<td>@Inherited</td>
<td>允许子类继承父类中的注解</td>
</tr>
</tbody></table>
<h3 id="编写注解处理器"><a href="#编写注解处理器" class="headerlink" title="编写注解处理器"></a>编写注解处理器</h3><p>有了处理器才能使注解发挥作用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PasswordUtils</span> </span>&#123;</span><br><span class="line">    <span class="meta">@UserCase</span>(id = <span class="number">47</span>, description = <span class="string">"Password must contain at least one numeric"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">vaildatePassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (password.matches(<span class="string">"\\w*\\d\\w*"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@UserCase</span>(id = <span class="number">48</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">encryptPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringBuilder(password).reverse().toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@UserCase</span>(id = <span class="number">49</span>, description = <span class="string">"Not equal"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkForNewPassword</span><span class="params">(List&lt;String&gt; prevPasswords, String password)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> !prevPasswords.contains(password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserCaseTracker</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">trackUseCases</span><span class="params">(List&lt;Integer&gt; useCases, Class&lt;?&gt; cl)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Method m : cl.getDeclaredMethods()) &#123;</span><br><span class="line">            UserCase uc = m.getAnnotation(UserCase.class);</span><br><span class="line">            <span class="keyword">if</span> (uc != <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Found Use Case:"</span> + uc.id() + <span class="string">" "</span> + uc.description());</span><br><span class="line">            &#125;</span><br><span class="line">            useCases.remove(<span class="keyword">new</span> Integer(uc.id()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i : useCases) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Warning:Missiong use case-"</span> + i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; useCases = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        Collections.addAll(useCases, <span class="number">47</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>);</span><br><span class="line">        trackUseCases(useCases, PasswordUtils.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Found Use Case:47 Password must contain at least one numeric</span></span><br><span class="line"><span class="comment">    Found Use Case:48 no description</span></span><br><span class="line"><span class="comment">    Found Use Case:49 Not equal</span></span><br><span class="line"><span class="comment">    Warning:Missiong use case-50</span></span><br><span class="line"><span class="comment">    * */</span></span><br></pre></td></tr></table></figure>

<p><strong>getAnnoation()</strong>方法返回指定类型的注解对象，若没有则返回null值</p>
<h3 id="注解元素可用的类型"><a href="#注解元素可用的类型" class="headerlink" title="注解元素可用的类型"></a>注解元素可用的类型</h3><ul>
<li>所以基本类型（int,float,boolean等）</li>
<li>Class</li>
<li>enum</li>
<li>Annotation(注解可以嵌套)</li>
<li>以上类型的数组</li>
</ul>
<h3 id="默认值限制"><a href="#默认值限制" class="headerlink" title="默认值限制"></a>默认值限制</h3><p>元素不能有不确定的值，元素必须要么具有默认值，要么在使用注解时提供元素的值。<br>其次，对于非基本类型的元素，无论是在源代码中声明时或是在注解接口中定义默认值时，都不能以null作为其值。</p>
<h3 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h3><p>APT(Annotation processing tool) 是一种处理注释的工具,它对源代码文件进行检测找出其中的Annotation，使用Annotation进行额外的处理。</p>
<p>Annotation处理器在处理Annotation时可以根据源文件中的Annotation生成额外的源文件和其它的文件(文件具体内容由Annotation处理器的编写者决定),APT还会编译生成的源文件和原来的源文件，将它们一起生成class文件.使用APT主要的目的是简化开发者的工作量。</p>
<p>因为APT可以编译程序源代码的同时，生成一些附属文件(比如源文件类文件程序发布描述文件等)，这些附属文件的内容也都是与源代码相关的，换句话说，使用APT可以代替传统的对代码信息和附属文件的维护工作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修饰表属性</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Persistent &#123;</span><br><span class="line"> <span class="function">String <span class="title">table</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修饰标识属性</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.FIELD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> IdProperty &#123;</span><br><span class="line"> <span class="function">String <span class="title">column</span><span class="params">()</span></span>;</span><br><span class="line"> <span class="function">String <span class="title">type</span><span class="params">()</span></span>;</span><br><span class="line"> <span class="function">String <span class="title">generator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修饰普通成员变量的Annotation </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target</span>(ElementType.FIELD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Property &#123;</span><br><span class="line"> <span class="function">String <span class="title">column</span><span class="params">()</span></span>;</span><br><span class="line"> <span class="function">String <span class="title">type</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>建立一个java类 使用以上注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 普通的Java类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Persistent</span>(table = <span class="string">"persons_table"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"> <span class="meta">@IdProperty</span>(column = <span class="string">"person_id"</span>, type = <span class="string">"integer"</span>, generator = <span class="string">"identity"</span>)</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"> <span class="meta">@Property</span>(column = <span class="string">"person_name"</span>, type = <span class="string">"string"</span>)</span><br><span class="line"> <span class="keyword">private</span> String name;</span><br><span class="line"> <span class="meta">@Property</span>(column = <span class="string">"person_age"</span>, type = <span class="string">"integer"</span>)</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> id;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.id = id;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> name;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> age;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面我们为这三个Annotation提供了一个Annotation处理器该处理器的功能是根据注释来生成一个Hibernate的映射文件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateAnnotationProcessor</span> <span class="keyword">implements</span> <span class="title">AnnotationProcessor</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Annotation处理器环境是该处理器与APT交互的重要途径</span></span><br><span class="line">    <span class="keyword">private</span> AnnotationProcessorEnvironment env;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造HibernateAnnotationProcessor对象时获得处理器环境</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HibernateAnnotationProcessor</span><span class="params">(AnnotationProcessorEnvironment env)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.env = env;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 循环处理每个对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 遍历每个class文件</span></span><br><span class="line">        <span class="keyword">for</span> (TypeDeclaration t : env.getSpecifiedTypeDeclarations()) &#123;</span><br><span class="line">            <span class="comment">// 定义一个文件输出流用于生成额外的文件</span></span><br><span class="line">            FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line">            <span class="comment">// 获取正在处理的类名</span></span><br><span class="line">            String clazzName = t.getSimpleName();</span><br><span class="line">            <span class="comment">// 获取类定义前的Persistent Annotation</span></span><br><span class="line">            Persistent per = t.getAnnotation(Persistent.class);</span><br><span class="line">            <span class="comment">// 当per Annotation不为空时才继续处理</span></span><br><span class="line">            <span class="keyword">if</span> (per != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// 创建文件输出流</span></span><br><span class="line">                    fos = <span class="keyword">new</span> FileOutputStream(clazzName + <span class="string">".hbm.xml"</span>);</span><br><span class="line">                    PrintStream ps = <span class="keyword">new</span> PrintStream(fos);</span><br><span class="line">                    <span class="comment">// 执行输出</span></span><br><span class="line">                    ps.println(<span class="string">"&lt;?xml version=\"1.0\"?&gt;"</span>);</span><br><span class="line">                    ps.println(<span class="string">"&lt;!DOCTYPE hibernate-mapping"</span>);</span><br><span class="line">                    ps.println(<span class="string">" PUBLIC \"-// Hibernate/Hibernate Mapping DTD 3.0//EN\""</span>);</span><br><span class="line">                    ps.println(<span class="string">" \"http:// hibernate.sourceforge.net/hibernate-mapping-3.0.dtd\"&gt;"</span>);</span><br><span class="line">                    ps.println(<span class="string">"&lt;hibernate-mapping&gt;"</span>);</span><br><span class="line">                    ps.print(<span class="string">" &lt;class name=\""</span> + t);</span><br><span class="line">                    <span class="comment">// 输出per的table()的值</span></span><br><span class="line">                    ps.println(<span class="string">"\" table=\""</span> + per.table() + <span class="string">"\"&gt;"</span>);</span><br><span class="line">                    <span class="keyword">for</span> (FieldDeclaration f : t.getFields()) &#123;</span><br><span class="line">                        <span class="comment">// 获取指定FieldDeclaration前面的IdProperty Annotation</span></span><br><span class="line">                        IdProperty id = f.getAnnotation(IdProperty.class);</span><br><span class="line">                        <span class="comment">// 如果id Annotation不为空</span></span><br><span class="line">                        <span class="keyword">if</span> (id != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            <span class="comment">// 执行输出</span></span><br><span class="line">                            ps.println(<span class="string">" &lt;id name=\""</span> + f.getSimpleName() + <span class="string">"\" column=\""</span> + id.column() + <span class="string">"\" type=\""</span> + id.type() + <span class="string">"\"&gt;"</span>);</span><br><span class="line">                            ps.println(<span class="string">" &lt;generator class=\""</span> + id.generator() + <span class="string">"\"/&gt;"</span>);</span><br><span class="line">                            ps.println(<span class="string">" &lt;/id&gt;"</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// 获取指定FieldDeclaration前面的Property Annotation</span></span><br><span class="line">                        Property p = f.getAnnotation(Property.class);</span><br><span class="line">                        <span class="comment">// 如果p Annotation不为空</span></span><br><span class="line">                        <span class="keyword">if</span> (p != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            <span class="comment">// 执行输出</span></span><br><span class="line">                            ps.println(<span class="string">" &lt;property name=\""</span> + f.getSimpleName() + <span class="string">"\" column=\""</span> + p.column() + <span class="string">"\"type=\""</span> + p.type() + <span class="string">"\"/&gt;"</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    ps.println(<span class="string">" &lt;/class&gt;"</span>);</span><br><span class="line">                    ps.println(<span class="string">"&lt;/hibernate-mapping&gt;"</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123; <span class="comment">// 关闭输出流</span></span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (fos != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            fos.close();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                        ex.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的Annotation处理器比较简单与前面通过反射来获取Annotation信息不同的是，这个Annotation处理器使用AnnotationProcessorEnvironment来获取Annotation信息AnnotationProcessorEnvironment包含了一个getSpecifiedTypeDeclarations方法，可获取所有需要处理的类声明，这个类声明可包括类，接口，和枚举等声明，由TypeDeclaration对象表地示与Classc对象的功能大致相似，区别只是TypeDeclaration是静态，只要有类文件就可以获得该对象而Class是动态的必须由虚拟机装载了指定类文件后才会产生。</p>
<p>TypeDeclaration又包含了如下三个常用方法来获得对应的程序元素</p>
<ul>
<li>getFields: 获取该类声明里的所有成员变量声明返回值是集合元素FieldDeclaration的集合</li>
<li>getMethods: 获取该类声明里的所有成员声明返回值是集合元素MethodDeclaration的集合</li>
<li>getPackage: 获取该类声明里的包声明返回值是TypeDeclaration.</li>
</ul>
<p>上面三个方法返回的TypeDeclaration,FieldDeclaration,MethodDeclaration都可调用getAnnotation方法来访问修饰它们的Annotation,上面程序中就是获取不同程序元素的Annotation的代码。<br>提供了上面的Annotation处理器类之后，还应该为该Annotation处理器提供一个处理工厂，处理工厂负责决定该处理器支持哪些Annotation，并通过getProcessorFor方法来生成一个Annotation处理对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.mirror.apt.*;</span><br><span class="line"><span class="keyword">import</span> com.sun.mirror.declaration.*;</span><br><span class="line"><span class="keyword">import</span> com.sun.mirror.type.*;</span><br><span class="line"><span class="keyword">import</span> com.sun.mirror.util.*;</span><br><span class="line"><span class="keyword">import</span> java.beans.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateAnnotationFactory</span> <span class="keyword">implements</span> <span class="title">AnnotationProcessorFactory</span> </span>&#123;</span><br><span class="line"> <span class="comment">// 所有支持的注释类型</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> Collection&lt;String&gt; <span class="title">supportedAnnotationTypes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Arrays.asList(<span class="string">"Property"</span>, <span class="string">"IdProperty"</span>, <span class="string">"Persistent"</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// 返回所有支持的选项</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> Collection&lt;String&gt; <span class="title">supportedOptions</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Arrays.asList(<span class="keyword">new</span> String[<span class="number">0</span>]);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// 返回Annotation处理器</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> AnnotationProcessor <span class="title">getProcessorFor</span><span class="params">( Set&lt;AnnotationTypeDeclaration&gt; atds, AnnotationProcessorEnvironment env)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> HibernateAnnotationProcessor(env);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>提供了上面的处理器工厂后就可以使用APT工具来处理上面的Person.java源文件。并根据该源文件来生成一个XML文件。 APT工具位于JDK的安装路径的bin路径下。<br>运行APT命令时，可以使用-factory选项来指定处理器工厂类。<br>如下所示 run.cmd，使用前注意配置Java环境变量：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt -factory HibernateAnnotationFactory Person.java</span><br></pre></td></tr></table></figure>

<h2 id="第二十一章（并发）"><a href="#第二十一章（并发）" class="headerlink" title="第二十一章（并发）"></a>第二十一章（并发）</h2><h3 id="Executor"><a href="#Executor" class="headerlink" title="Executor"></a>Executor</h3><p><strong>newCachedThreadPool()</strong> 创建一个可根据需要创建新线程的线程池，但是在以前构造的线程可用时将重用它们。对于执行很多短期异步任务的程序而言，这些线程池通常可提高程序性能。调用 execute 将重用以前构造的线程（如果线程可用）。如果现有线程没有可用的，则创建一个新线程并添加到池中。终止并从缓存中移除那些已有 60 秒钟未被使用的线程。</p>
<p><strong>newFixedThreadPool(int nThreads)</strong><br>创建一个可重用固定线程数的线程池，以共享的无界队列方式来运行这些线程。在任意点，在大多数 nThreads 线程会处于处理任务的活动状态。如果在所有线程处于活动状态时提交附加任务，则在有可用线程之前，附加任务将在队列中等待。如果在关闭前的执行期间由于失败而导致任何线程终止，那么一个新线程将代替它执行后续的任务（如果需要）。在某个线程被显式地关闭之前，池中的线程将一直存在。新的线程加入后，如果正在运行的线程达到了上限，则会阻塞，直到有了空闲的线程来运行。 </p>
<p><code>Executor.shutdown()</code> 这个方法调用可以防止新任务被提交给这个Executor,当前线程将继续运行在shutdown()被调用之前提交的所有任务。</p>
<p>利用 <code>Callable</code> 接口接收 Runnable 运行后返回的结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallableDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ExecutorService exec = Executors.newCachedThreadPool();</span><br><span class="line">        List&lt;Future&lt;String&gt;&gt; results = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            results.add(exec.submit(<span class="keyword">new</span> TaskWithResult(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(Future&lt;String&gt; future: results)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.println(future.get());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (ExecutionException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 0</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 1</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 2</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 3</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 4</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 5</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 6</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 7</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 8</span></span><br><span class="line"><span class="comment">    result of TaskWithResult 9</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TaskWithResult</span> <span class="keyword">implements</span> <span class="title">Callable</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TaskWithResult</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"result of TaskWithResult "</span> + id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// old-style</span></span><br><span class="line"><span class="comment">// Thread.sleep(100);</span></span><br><span class="line"><span class="comment">// Java SE5/6-style</span></span><br><span class="line">TimeUnit.MILLISECONDS.sleep(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<p><code>setPriority()</code>优先级是在run()的开头部分设定的，在构造器中设置不会有任何好处，因为Executor在此刻还没有开始执行任务。<br>调整优先级时，最好只使用<strong>MAX_PRIORITY</strong>,<strong>NORM_PRIORITY</strong>,<strong>MIN_PRIORITY</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">thread.setDaemon(<span class="keyword">true</span>);<span class="comment">//设置后台线程，只有当所有非后台线程终止时，后台线程才会结束</span></span><br></pre></td></tr></table></figure>

<p><strong>ThreadFactory</strong>可以定制由Executor创建的线程的属性（后台、优先级、名称）。<br>后台线程在所有非后台终止时，会“突然”终止，一旦main()退出，JVM就会立即关闭所有的后台进程，而不会有任何形式的确认行为（比如说不会执行finally语句）。</p>
<p>一个线程可以在其他线程上调用join()方法，其效果是等待一段时间直到第二个线程结束才继续执行。如果某个线程在另一个线程t上调用t.join()，此线程将会被挂起，直到目标线程t结束才恢复（即t.isActive()返回为假）。</p>
<p>可以通过<strong>Thread.UncaughtExceptionHandler</strong>来捕获线程上溢出的异常。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">thread.setUncaughtExceptionHandler(<span class="keyword">new</span> MyUncaughtExceptionHandler());</span><br><span class="line">Thread.setUncaughtExceptionHandler(<span class="keyword">new</span> MyUncaughtExceptionHandler());<span class="comment">//静态域，全局使用</span></span><br></pre></td></tr></table></figure>

<h3 id="共享受限资源"><a href="#共享受限资源" class="headerlink" title="共享受限资源"></a>共享受限资源</h3><p>使用<strong>synchronized</strong>标记来防止资源冲突。<br>所有对象都自动含有单一的锁（也成为监视器）</p>
<ul>
<li>当两个并发线程访问同一个对象object中的这个synchronized(this)同步代码块时，一个时间内只能有一个线程得到执行。另一个线程必须等待当前线程执行完这个代码块以后才能执行该代码块。</li>
<li>然而，当一个线程访问object的一个synchronized(this)同步代码块时，另一个线程仍然可以访问该object中的非synchronized(this)同步代码块。</li>
<li>尤其关键的是，当一个线程访问object的一个synchronized(this)同步代码块时，其他线程对object中所有其它synchronized(this)同步代码块的访问将被阻塞。</li>
<li>第三个例子同样适用其它同步代码块。也就是说，当一个线程访问object的一个synchronized(this)同步代码块时，它就获得了这个object的对象锁。结果，其它线程对该object对象所有同步代码部分的访问都被暂时阻塞。</li>
<li>以上规则对其它对象锁同样适用.</li>
</ul>
<p>synchronized 关键字，它包括两种用法：synchronized 方法和 synchronized 块，规则同上</p>
<p>可以<code>synchronized(xx.class)</code>来锁住一个类而不是对象。</p>
<p>使用<code>java.util.concurrent.locks</code>中的显式互斥机制。Lock对象必须被显式地创建、锁定和释放。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Lock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">next</span><span class="params">()</span></span>&#123;</span><br><span class="line">       lock.lock();</span><br><span class="line">       <span class="keyword">try</span>&#123;</span><br><span class="line">           <span class="comment">//do something</span></span><br><span class="line">           Thread.yield();</span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">           lock.unlock();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>对Lock()的调用，必须放在finally子句中带有unlock()的try-finally语句中。return语句要在try子句中出现，以确保unlock()不会过早发生。</p>
<p>ReentrantLock允许你尝试着获取但最终未获取锁，如果其他人已经获取了这个锁，那你可以决定离开去执行其他一些事情，而不是等待这个锁被释放。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lock.tryLock();</span><br><span class="line"></span><br><span class="line">lock.tryLock(<span class="number">2</span>,TimeUnit.SECONDS);</span><br></pre></td></tr></table></figure>

<p><a href="http://www.ibm.com/developerworks/cn/java/j-jtp06197.html" target="_blank" rel="noopener">正确使用Volatile变量</a></p>
<p>要使 volatile 变量提供理想的线程安全，必须同时满足下面两个条件：</p>
<blockquote>
<p>对变量的写操作不依赖于当前值。<br>该变量没有包含在具有其他变量的不变式中。</p>
</blockquote>
<p>实际上，这些条件表明，可以被写入 volatile 变量的这些有效值独立于任何程序的状态，包括变量的当前状态。 </p>
<p>结合使用 volatile 和 synchronized 实现“开销较低的读－写锁” </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheesyCounter</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Employs the cheap read-write lock trick</span></span><br><span class="line">    <span class="comment">// All mutative operations MUST be done with the 'this' lock held</span></span><br><span class="line">    <span class="meta">@GuardedBy</span>(<span class="string">"this"</span>) <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">increment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过原子类（AtomicInteger、AtomicLong、AtomicReference）可以有效减少synchronized关键字和Lock显式锁的使用。但一般减少使用，只需在特殊情况下使用即可。</p>
<p><strong>ThreadLocal</strong>对象通常当作静态域存储，它为每个单独的线程分配了自己的存储。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadLocalVariableHolder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Integer&gt; value = <span class="keyword">new</span> ThreadLocal&lt;Integer&gt;() &#123;</span><br><span class="line">        <span class="keyword">private</span> Random rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">synchronized</span> Integer <span class="title">initialValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> rand.nextInt(<span class="number">10000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">increment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        value.set(value.get() + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        ExecutorService exec = Executors.newCachedThreadPool();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            exec.execute(<span class="keyword">new</span> Accessor(i));</span><br><span class="line">        &#125;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">3</span>);</span><br><span class="line">        exec.shutdownNow();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    #0:9259</span></span><br><span class="line"><span class="comment">    #1:556</span></span><br><span class="line"><span class="comment">    #2:6694</span></span><br><span class="line"><span class="comment">    #3:1862</span></span><br><span class="line"><span class="comment">    #4:962</span></span><br><span class="line"><span class="comment">    #0:9260</span></span><br><span class="line"><span class="comment">    #1:557</span></span><br><span class="line"><span class="comment">    #2:6695</span></span><br><span class="line"><span class="comment">    #3:1863</span></span><br><span class="line"><span class="comment">    #4:963</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Accessor</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Accessor</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!Thread.currentThread().isInterrupted()) &#123;</span><br><span class="line">            ThreadLocalVariableHolder.increment();</span><br><span class="line">            System.out.println(<span class="keyword">this</span>);</span><br><span class="line">            Thread.yield();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"#"</span> + id + <span class="string">":"</span> + ThreadLocalVariableHolder.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="终结任务"><a href="#终结任务" class="headerlink" title="终结任务"></a>终结任务</h3><p>线程状态：<code>新建</code>、<code>就绪</code>、<code>阻塞</code>、<code>死亡</code>。</p>
<p>进入阻塞的情况：</p>
<ul>
<li>调用sleep()使任务进入休眠状态</li>
<li>调用wait()线程挂起，需要notify()或notifyAll()来唤醒</li>
<li>等待输入输出</li>
<li>调用对象的同步控制方法，但对象锁不可用</li>
</ul>
<p>Thread类包含interrupt()方法，因此可以终止被阻塞的任务，但若线程已经被阻塞或正试图执行一个阻塞操作那么设置中断状态将会抛出InterruptedException。<br>可以通过Executor的<strong>shutdownNow()</strong> 来中断它启动的线程。也可以通过submit()方法获得线程的Future,再通过 <strong>Future.cancel()</strong> 来中断特定线程。</p>
<p>Thread.interrupt()方法不会中断一个正在运行的线程。这一方法实际上完成的是，在线程受到阻塞时抛出一个中断信号，这样线程就得以退出阻塞的状态。更确切的说，如果线程被Object.wait, Thread.join和Thread.sleep三种方法之一阻塞，那么，它将接收到一个中断异常（InterruptedException），从而提早地终结被阻塞状态。 </p>
<p>因此最好的方法是设置共享变量，并调用interrupt(),双重检查下确保线程能准确退出。</p>
<h3 id="线程之间协作"><a href="#线程之间协作" class="headerlink" title="线程之间协作"></a>线程之间协作</h3><p>对于wait()而言</p>
<ul>
<li>在wait()期间对象锁是释放的</li>
<li>可以通过notify()、notifyAll()，或者令时间到期，从wait()中恢复执行。</li>
</ul>
<p>wait()的标准写法，防止错失竞争信号</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(sharedMonitor)&#123;</span><br><span class="line">    <span class="keyword">while</span>(someCondition)&#123;</span><br><span class="line">        sharedMonitor.wait();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当notifyAll()因某个特定锁而被调用时，只有等待这个锁的任务才会被唤醒。</p>
<h3 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h3><p>从哲学家问题可以看出，要发生死锁必须要满足以下4个条件：</p>
<ul>
<li>互斥条件。任务使用的资源至少有一个是不能共享的。</li>
<li>至少有一个任务它必须持有一个资源且正在等待获取一个当前被别的任务持有的资源。</li>
<li>资源不能被抢占，任务必须把资源释放当作普通事件。</li>
<li>必须要有循环等待，这时，一个任务等待其他任务所持有的资源，后者又在等待另一个任务所持有的资源。</li>
</ul>
<h3 id="新类库-concurrent"><a href="#新类库-concurrent" class="headerlink" title="新类库 concurrent"></a>新类库 concurrent</h3><h4 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountDownLatchDemo</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> SimpleDateFormat sdf=<span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;  </span><br><span class="line">        CountDownLatch latch=<span class="keyword">new</span> CountDownLatch(<span class="number">2</span>);<span class="comment">//两个工人的协作  </span></span><br><span class="line">        Worker worker1=<span class="keyword">new</span> Worker(<span class="string">"zhang san"</span>, <span class="number">5000</span>, latch);  </span><br><span class="line">        Worker worker2=<span class="keyword">new</span> Worker(<span class="string">"li si"</span>, <span class="number">8000</span>, latch);  </span><br><span class="line">        worker1.start();<span class="comment">//  </span></span><br><span class="line">        worker2.start();<span class="comment">//  </span></span><br><span class="line">        latch.await();<span class="comment">//等待所有工人完成工作  </span></span><br><span class="line">        System.out.println(<span class="string">"all work done at "</span>+sdf.format(<span class="keyword">new</span> Date()));  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Worker</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;  </span><br><span class="line">        String workerName;   </span><br><span class="line">        <span class="keyword">int</span> workTime;  </span><br><span class="line">        CountDownLatch latch;  </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Worker</span><span class="params">(String workerName ,<span class="keyword">int</span> workTime ,CountDownLatch latch)</span></span>&#123;  </span><br><span class="line">             <span class="keyword">this</span>.workerName=workerName;  </span><br><span class="line">             <span class="keyword">this</span>.workTime=workTime;  </span><br><span class="line">             <span class="keyword">this</span>.latch=latch;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;  </span><br><span class="line">            System.out.println(<span class="string">"Worker "</span>+workerName+<span class="string">" do work begin at "</span>+sdf.format(<span class="keyword">new</span> Date()));  </span><br><span class="line">            doWork();<span class="comment">//工作了  </span></span><br><span class="line">            System.out.println(<span class="string">"Worker "</span>+workerName+<span class="string">" do work complete at "</span>+sdf.format(<span class="keyword">new</span> Date()));  </span><br><span class="line">            latch.countDown();<span class="comment">//工人完成工作，计数器减一  </span></span><br><span class="line">  </span><br><span class="line">        &#125;  </span><br><span class="line">          </span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span></span>&#123;  </span><br><span class="line">            <span class="keyword">try</span> &#123;  </span><br><span class="line">                Thread.sleep(workTime);  </span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;  </span><br><span class="line">                e.printStackTrace();  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CountDownLatch是通过一个计数器来实现的，计数器的初始值为线程的数量。每当一个线程完成了自己的任务后，计数器的值就会减1。当计数器值到达0时，它表示所有的线程已经完成了任务，然后在闭锁上等待的线程就可以恢复执行任务。CountDownLatch很像一个线程闸，通过<code>await()</code>方法阻塞主线程等待闸内的线程完成，当计数器为0时主线程恢复。</p>
<h4 id="CyclicBarrier"><a href="#CyclicBarrier" class="headerlink" title="CyclicBarrier"></a>CyclicBarrier</h4><p>CyclicBarrier的字面意思是可循环使用（Cyclic）的屏障（Barrier）。它要做的事情是，让一组线程到达一个屏障（也可以叫同步点）时被阻塞，直到最后一个线程到达屏障时，屏障才会开门，所有被屏障拦截的线程才会继续干活。CyclicBarrier默认的构造方法是CyclicBarrier(int parties)，其参数表示屏障拦截的线程数量，每个线程调用await方法告诉CyclicBarrier我已经到达了屏障，然后当前线程被阻塞。<br>CyclicBarrier还提供一个更高级的构造函数CyclicBarrier(int parties, Runnable barrierAction)，用于在线程到达屏障时，优先执行barrierAction，方便处理更复杂的业务场景。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CyclicBarrierTest2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> CyclicBarrier c = <span class="keyword">new</span> CyclicBarrier(<span class="number">2</span>, <span class="keyword">new</span> A());</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"></span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					c.await();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;).start();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			c.await();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="number">2</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">			System.out.println(<span class="number">3</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>CyclicBarrier和CountDownLatch的区别</p>
<ul>
<li>CountDownLatch的计数器只能使用一次。而CyclicBarrier的计数器可以使用reset() 方法重置。所以CyclicBarrier能处理更为复杂的业务场景，比如如果计算发生错误，可以重置计数器，并让线程们重新执行一次。</li>
<li>CyclicBarrier还提供其他有用的方法，比如getNumberWaiting方法可以获得CyclicBarrier阻塞的线程数量。isBroken方法用来知道阻塞的线程是否被中断。比如以下代码执行完之后会返回true。</li>
<li>CyclicBarrier中线程到达“屏障”时会被阻塞。</li>
</ul>
<h4 id="Semaphore"><a href="#Semaphore" class="headerlink" title="Semaphore"></a>Semaphore</h4><p>Semaphore的构造方法Semaphore(int permits) 接受一个整型的数字，表示可用的许可证数量。Semaphore(10)表示允许10个线程获取许可证，也就是最大并发数是10。Semaphore的用法也很简单，首先线程使用Semaphore的acquire()获取一个许可证，使用完之后调用release()归还许可证。还可以用tryAcquire()方法尝试获取许可证。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	s.acquire();</span><br><span class="line">	System.out.println(<span class="string">"save data"</span>);</span><br><span class="line">	s.release();</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="DelayQueue"><a href="#DelayQueue" class="headerlink" title="DelayQueue"></a>DelayQueue</h4><p>DelayQueue是一个BlockingQueue，其特化的参数是Delayed。（不了解BlockingQueue的同学，先去了解BlockingQueue再看本文）<br>Delayed扩展了Comparable接口，比较的基准为延时的时间值，Delayed接口的实现类getDelay的返回值应为固定值（final）。DelayQueue内部是使用PriorityQueue实现的。</p>
<p><code>DelayQueue = BlockingQueue + PriorityQueue + Delayed</code></p>
<h4 id="Exchanger"><a href="#Exchanger" class="headerlink" title="Exchanger"></a>Exchanger</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Exchanger&lt;List&lt;Integer&gt;&gt; exchanger = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Producer</span><span class="params">(Exchanger&lt;List&lt;Integer&gt;&gt; exchanger)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.exchanger = exchanger;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">            list.clear();</span><br><span class="line">            list.add(rand.nextInt(<span class="number">10000</span>));</span><br><span class="line">            list.add(rand.nextInt(<span class="number">10000</span>));</span><br><span class="line">            list.add(rand.nextInt(<span class="number">10000</span>));</span><br><span class="line">            list.add(rand.nextInt(<span class="number">10000</span>));</span><br><span class="line">            list.add(rand.nextInt(<span class="number">10000</span>));</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                list = exchanger.exchange(list);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Exchanger&lt;List&lt;Integer&gt;&gt; exchanger = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Consumer</span><span class="params">(Exchanger&lt;List&lt;Integer&gt;&gt; exchanger)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.exchanger = exchanger;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                list = exchanger.exchange(list);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.print(list.get(<span class="number">0</span>)+<span class="string">", "</span>);</span><br><span class="line">            System.out.print(list.get(<span class="number">1</span>)+<span class="string">", "</span>);</span><br><span class="line">            System.out.print(list.get(<span class="number">2</span>)+<span class="string">", "</span>);</span><br><span class="line">            System.out.print(list.get(<span class="number">3</span>)+<span class="string">", "</span>);</span><br><span class="line">            System.out.println(list.get(<span class="number">4</span>)+<span class="string">", "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExchangerDemo</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Exchanger&lt;List&lt;Integer&gt;&gt; exchanger = <span class="keyword">new</span> Exchanger&lt;&gt;();</span><br><span class="line">        <span class="keyword">new</span> Consumer(exchanger).start();</span><br><span class="line">        <span class="keyword">new</span> Producer(exchanger).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Exchanger是在两个任务之间交换对象。</p>
<p>当线程A调用Exchange对象的exchange()方法后，他会陷入阻塞状态，直到线程B也调用了exchange()方法，然后以线程安全的方式交换数据，之后线程A和B继续运行</p>
<h4 id="ReadWriteLock"><a href="#ReadWriteLock" class="headerlink" title="ReadWriteLock"></a>ReadWriteLock</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ReentrantReadWriteLock lock =</span><br><span class="line">            <span class="keyword">new</span> ReentrantReadWriteLock(<span class="keyword">true</span>);</span><br><span class="line">            </span><br><span class="line">Lock wlock = lock.writeLock();<span class="comment">//获取写锁</span></span><br><span class="line">Lock rlock = lock.readLock();<span class="comment">//获取读锁</span></span><br><span class="line">lock.getReadLockCount();<span class="comment">//获取读锁的个数</span></span><br></pre></td></tr></table></figure>

<p>ReadWriteLock 对向数据结构相对不频繁写入，但是有多个任务要经常读取这个数据结构的这类情况进行了优化。ReadWriteLock使得你可以同时有多个读取者，只要它们都不试图写入即可。如果写锁已经被其他任务持有，那么任何读取者都不能访问。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>关于最后的<code>图形化用户界面</code>章节，基本上讲的是如何使用Swing上的UI控件，所以略过。</p>
<p>断断续续的看完这本《Java编程思想》，只能说不愧是java语言最经典的教材，除去阅读时不断巩固自己在java上的知识，还能时不时的发现之前没有用到过的java技术，让人获益匪浅啊！</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/java/" rel="tag">#java</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/11/02/Android开发日记（十二）——PermissionBuilder/" rel="next" title="Android开发日记（十二）—— Android 6.0权限管理">
                <i class="fa fa-chevron-left"></i> Android开发日记（十二）—— Android 6.0权限管理
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/22/在Centos下部署python环境/" rel="prev" title="在Centos下部署python环境">
                在Centos下部署python环境 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/11/29/Java编程思想阅读笔记/" data-title="Java编程思想阅读笔记" data-url="http://www.cpacm.net/2016/11/29/Java编程思想阅读笔记/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/img/author.jpg" alt="cpacm">
          <p class="site-author-name" itemprop="name">cpacm</p>
          <p class="site-description motion-element" itemprop="description">请不要忘记，那给你带来感动的，名为二次元的理想乡。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">52</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/cpacm" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/3053253821" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/cpacm/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#第一章（对象导论）"><span class="nav-number">1.</span> <span class="nav-text">第一章（对象导论）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#面向基本语言的五大特性"><span class="nav-number">1.1.</span> <span class="nav-text">面向基本语言的五大特性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二章（一切都是对象）"><span class="nav-number">2.</span> <span class="nav-text">第二章（一切都是对象）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、存储"><span class="nav-number">2.1.</span> <span class="nav-text">一、存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、基本类型"><span class="nav-number">2.2.</span> <span class="nav-text">二、基本类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三章（操作符）"><span class="nav-number">3.</span> <span class="nav-text">第三章（操作符）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、别名现象"><span class="nav-number">3.1.</span> <span class="nav-text">一、别名现象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、equals方法"><span class="nav-number">3.2.</span> <span class="nav-text">二、equals方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、短路"><span class="nav-number">3.3.</span> <span class="nav-text">三、短路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、e"><span class="nav-number">3.4.</span> <span class="nav-text">四、e</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#五、位操作"><span class="nav-number">3.5.</span> <span class="nav-text">五、位操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#六、截尾"><span class="nav-number">3.6.</span> <span class="nav-text">六、截尾</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第四章（控制执行流程）"><span class="nav-number">4.</span> <span class="nav-text">第四章（控制执行流程）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、goto-标签"><span class="nav-number">4.1.</span> <span class="nav-text">一、goto 标签</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第五章（初始化与清理）"><span class="nav-number">5.</span> <span class="nav-text">第五章（初始化与清理）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、重载"><span class="nav-number">5.1.</span> <span class="nav-text">一、重载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、垃圾回收机制"><span class="nav-number">5.2.</span> <span class="nav-text">二、垃圾回收机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、初始化顺序"><span class="nav-number">5.3.</span> <span class="nav-text">三、初始化顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、可变参数列表。"><span class="nav-number">5.4.</span> <span class="nav-text">四、可变参数列表。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第六章（访问权限控制）"><span class="nav-number">6.</span> <span class="nav-text">第六章（访问权限控制）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、访问权限途径"><span class="nav-number">6.1.</span> <span class="nav-text">一、访问权限途径</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第七章（复用类）"><span class="nav-number">7.</span> <span class="nav-text">第七章（复用类）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、toString-的自动调用"><span class="nav-number">7.1.</span> <span class="nav-text">一、toString()的自动调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、构造函数调用顺序"><span class="nav-number">7.2.</span> <span class="nav-text">二、构造函数调用顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、final"><span class="nav-number">7.3.</span> <span class="nav-text">三、final</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、组合模式"><span class="nav-number">7.4.</span> <span class="nav-text">四、组合模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第八章（多态）"><span class="nav-number">8.</span> <span class="nav-text">第八章（多态）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、多态缺陷"><span class="nav-number">8.1.</span> <span class="nav-text">一、多态缺陷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、断言"><span class="nav-number">8.2.</span> <span class="nav-text">二、断言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、构造器构造顺序"><span class="nav-number">8.3.</span> <span class="nav-text">三、构造器构造顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、构造器初始化"><span class="nav-number">8.4.</span> <span class="nav-text">三、构造器初始化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第九章（接口）"><span class="nav-number">9.</span> <span class="nav-text">第九章（接口）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#访问权限"><span class="nav-number">9.1.</span> <span class="nav-text">访问权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重名"><span class="nav-number">9.2.</span> <span class="nav-text">重名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#策略模式"><span class="nav-number">9.3.</span> <span class="nav-text">策略模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#适配器模式"><span class="nav-number">9.4.</span> <span class="nav-text">适配器模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#工厂模式"><span class="nav-number">9.5.</span> <span class="nav-text">工厂模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十章（内部类）"><span class="nav-number">10.</span> <span class="nav-text">第十章（内部类）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、访问权"><span class="nav-number">10.1.</span> <span class="nav-text">一、访问权</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、-new"><span class="nav-number">10.2.</span> <span class="nav-text">二、.new</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、局部"><span class="nav-number">10.3.</span> <span class="nav-text">三、局部</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、匿名内部类"><span class="nav-number">10.4.</span> <span class="nav-text">四、匿名内部类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#五、嵌套类"><span class="nav-number">10.5.</span> <span class="nav-text">五、嵌套类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#六、接口内部类"><span class="nav-number">10.6.</span> <span class="nav-text">六、接口内部类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#七、内部类作用"><span class="nav-number">10.7.</span> <span class="nav-text">七、内部类作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#八、模版模式"><span class="nav-number">10.8.</span> <span class="nav-text">八、模版模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#九、命令设计模式"><span class="nav-number">10.9.</span> <span class="nav-text">九、命令设计模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#十、继承内部类"><span class="nav-number">10.10.</span> <span class="nav-text">十、继承内部类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十一章（持有对象）"><span class="nav-number">11.</span> <span class="nav-text">第十一章（持有对象）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、各个容器"><span class="nav-number">11.1.</span> <span class="nav-text">一、各个容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、迭代器"><span class="nav-number">11.2.</span> <span class="nav-text">二、迭代器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、栈"><span class="nav-number">11.3.</span> <span class="nav-text">二、栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、队列"><span class="nav-number">11.4.</span> <span class="nav-text">三、队列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、优先队列"><span class="nav-number">11.5.</span> <span class="nav-text">三、优先队列</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十二章（通过异常处理错误）"><span class="nav-number">12.</span> <span class="nav-text">第十二章（通过异常处理错误）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义异常"><span class="nav-number">12.1.</span> <span class="nav-text">自定义异常</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rethrow"><span class="nav-number">12.2.</span> <span class="nav-text">Rethrow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#异常链"><span class="nav-number">12.3.</span> <span class="nav-text">异常链</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#return"><span class="nav-number">12.4.</span> <span class="nav-text">return</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#异常使用指南"><span class="nav-number">12.5.</span> <span class="nav-text">异常使用指南</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十三章（字符串）"><span class="nav-number">13.</span> <span class="nav-text">第十三章（字符串）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#格式修饰符"><span class="nav-number">13.1.</span> <span class="nav-text">格式修饰符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#正则表达式"><span class="nav-number">13.2.</span> <span class="nav-text">正则表达式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十四章（类型信息）"><span class="nav-number">14.</span> <span class="nav-text">第十四章（类型信息）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Class类"><span class="nav-number">14.1.</span> <span class="nav-text">Class类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#类使用"><span class="nav-number">14.2.</span> <span class="nav-text">类使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#静态常量"><span class="nav-number">14.3.</span> <span class="nav-text">静态常量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Java之外观模式（Facade-Pattern）"><span class="nav-number">14.4.</span> <span class="nav-text">Java之外观模式（Facade Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RTTI和反射的区别"><span class="nav-number">14.5.</span> <span class="nav-text">RTTI和反射的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#class内部方法"><span class="nav-number">14.6.</span> <span class="nav-text">class内部方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代理模式"><span class="nav-number">14.7.</span> <span class="nav-text">代理模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#反射修改"><span class="nav-number">14.8.</span> <span class="nav-text">反射修改</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十五章（泛型）"><span class="nav-number">15.</span> <span class="nav-text">第十五章（泛型）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念"><span class="nav-number">15.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#元组"><span class="nav-number">15.2.</span> <span class="nav-text">元组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#局限1"><span class="nav-number">15.3.</span> <span class="nav-text">局限1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#泛型方法"><span class="nav-number">15.4.</span> <span class="nav-text">泛型方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#局限2-擦除"><span class="nav-number">15.5.</span> <span class="nav-text">局限2-擦除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参数化接口"><span class="nav-number">15.6.</span> <span class="nav-text">参数化接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#装饰器模式"><span class="nav-number">15.7.</span> <span class="nav-text">装饰器模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#定义"><span class="nav-number">15.7.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#特点"><span class="nav-number">15.7.2.</span> <span class="nav-text">特点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#潜在类型机制"><span class="nav-number">15.8.</span> <span class="nav-text">潜在类型机制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十六章（数组）"><span class="nav-number">16.</span> <span class="nav-text">第十六章（数组）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#特性"><span class="nav-number">16.1.</span> <span class="nav-text">特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多维数组"><span class="nav-number">16.2.</span> <span class="nav-text">多维数组</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十七章（容器深入研究）"><span class="nav-number">17.</span> <span class="nav-text">第十七章（容器深入研究）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#List"><span class="nav-number">17.1.</span> <span class="nav-text">List</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Set"><span class="nav-number">17.2.</span> <span class="nav-text">Set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Queue"><span class="nav-number">17.3.</span> <span class="nav-text">Queue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Map"><span class="nav-number">17.4.</span> <span class="nav-text">Map</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#容器选择"><span class="nav-number">17.5.</span> <span class="nav-text">容器选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同步控制"><span class="nav-number">17.6.</span> <span class="nav-text">同步控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#持有引用"><span class="nav-number">17.7.</span> <span class="nav-text">持有引用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十八章（Java-IO-系统）"><span class="nav-number">18.</span> <span class="nav-text">第十八章（Java IO 系统）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#File"><span class="nav-number">18.1.</span> <span class="nav-text">File</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-O"><span class="nav-number">18.2.</span> <span class="nav-text">I/O</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用RandomAccessFile写入文件"><span class="nav-number">18.3.</span> <span class="nav-text">使用RandomAccessFile写入文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于字节流和字符流的区别"><span class="nav-number">18.4.</span> <span class="nav-text">关于字节流和字符流的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OutputStreramWriter-和-InputStreamReader"><span class="nav-number">18.5.</span> <span class="nav-text">OutputStreramWriter 和 InputStreamReader</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SequenceInputStream"><span class="nav-number">18.6.</span> <span class="nav-text">SequenceInputStream</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#java内部执行其他操作系统的程序"><span class="nav-number">18.7.</span> <span class="nav-text">java内部执行其他操作系统的程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NIO"><span class="nav-number">18.8.</span> <span class="nav-text">NIO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#序列化"><span class="nav-number">18.9.</span> <span class="nav-text">序列化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#transient-瞬时-关键字"><span class="nav-number">18.10.</span> <span class="nav-text">transient (瞬时)关键字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用“持久化”"><span class="nav-number">18.11.</span> <span class="nav-text">使用“持久化”</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第十九章（枚举类型）"><span class="nav-number">19.</span> <span class="nav-text">第十九章（枚举类型）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#values"><span class="nav-number">19.1.</span> <span class="nav-text">values()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Enum-泛型使用示例"><span class="nav-number">19.2.</span> <span class="nav-text">Enum 泛型使用示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EnumSet-和-EnumMap"><span class="nav-number">19.3.</span> <span class="nav-text">EnumSet 和 EnumMap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二十章（注解）"><span class="nav-number">20.</span> <span class="nav-text">第二十章（注解）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本语法"><span class="nav-number">20.1.</span> <span class="nav-text">基本语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编写注解处理器"><span class="nav-number">20.2.</span> <span class="nav-text">编写注解处理器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注解元素可用的类型"><span class="nav-number">20.3.</span> <span class="nav-text">注解元素可用的类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#默认值限制"><span class="nav-number">20.4.</span> <span class="nav-text">默认值限制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#apt"><span class="nav-number">20.5.</span> <span class="nav-text">apt</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二十一章（并发）"><span class="nav-number">21.</span> <span class="nav-text">第二十一章（并发）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Executor"><span class="nav-number">21.1.</span> <span class="nav-text">Executor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#共享受限资源"><span class="nav-number">21.2.</span> <span class="nav-text">共享受限资源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#终结任务"><span class="nav-number">21.3.</span> <span class="nav-text">终结任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#线程之间协作"><span class="nav-number">21.4.</span> <span class="nav-text">线程之间协作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#死锁"><span class="nav-number">21.5.</span> <span class="nav-text">死锁</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#新类库-concurrent"><span class="nav-number">21.6.</span> <span class="nav-text">新类库 concurrent</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CountDownLatch"><span class="nav-number">21.6.1.</span> <span class="nav-text">CountDownLatch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CyclicBarrier"><span class="nav-number">21.6.2.</span> <span class="nav-text">CyclicBarrier</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Semaphore"><span class="nav-number">21.6.3.</span> <span class="nav-text">Semaphore</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DelayQueue"><span class="nav-number">21.6.4.</span> <span class="nav-text">DelayQueue</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exchanger"><span class="nav-number">21.6.5.</span> <span class="nav-text">Exchanger</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ReadWriteLock"><span class="nav-number">21.6.6.</span> <span class="nav-text">ReadWriteLock</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">22.</span> <span class="nav-text">总结</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cpacm</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"cpacm"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("2fmsJHBmgPTnmd1bc7R9GcVX-gzGzoHsz", "CBUSqxdc9PSLibNV3TzlhpWg");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
